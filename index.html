<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPG Fantasy Online</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Cinzel:wght@400;700&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8B4513;
            --secondary-color: #D2691E;
            --accent-color: #CD853F;
            --dark-color: #3D2B1F;
            --light-color: #F5DEB3;
            --success-color: #228B22;
            --danger-color: #8B0000;
            --warning-color: #FFD700;
            --info-color: #1E90FF;
            --magic-color: #8A2BE2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cinzel', serif;
            background: url('https://images.unsplash.com/photo-1518709268805-4e9042af2176?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
            background-size: cover;
            color: var(--light-color);
            min-height: 100vh;
            padding: 10px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
            border-radius: 10px;
            border: 2px solid var(--secondary-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        .game-title {
            font-family: 'UnifrakturMaguntia', cursive;
            font-size: 2.5rem;
            color: var(--warning-color);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            margin-bottom: 5px;
        }

        .player-info {
            display: flex;
            justify-content: space-between;
            background: rgba(61, 43, 31, 0.8);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--accent-color);
            flex-wrap: wrap;
        }

        .info-item {
            text-align: center;
            flex: 1;
            min-width: 80px;
        }

        .info-label {
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .info-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--light-color);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), var(--warning-color));
            border-radius: 4px;
            transition: width 0.3s;
        }

        .nav-tabs {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background: rgba(61, 43, 31, 0.8);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--accent-color);
            flex-wrap: wrap;
        }

        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 12px 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            border-right: 1px solid var(--accent-color);
            min-width: 100px;
        }

        .nav-tab:last-child {
            border-right: none;
        }

        .nav-tab.active {
            background: var(--primary-color);
            color: var(--warning-color);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(139, 69, 19, 0.5);
        }

        .tab-content {
            display: none;
            background: rgba(61, 43, 31, 0.9);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--accent-color);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            min-height: 400px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .section-title {
            font-family: 'MedievalSharp', cursive;
            font-size: 1.5rem;
            color: var(--warning-color);
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 8px;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .action-card {
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid var(--accent-color);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .action-card.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .action-card.disabled:hover {
            transform: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
        }

        .action-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--warning-color);
        }

        .action-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .action-desc {
            font-size: 0.8rem;
            color: var(--light-color);
            opacity: 0.8;
        }

        .cooldown {
            margin-top: 8px;
            font-size: 0.7rem;
            color: var(--danger-color);
        }

        .energy-cost {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--magic-color);
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .inventory-item {
            background: rgba(210, 105, 30, 0.2);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            border: 1px solid var(--accent-color);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .inventory-item:hover {
            background: rgba(210, 105, 30, 0.4);
        }

        .item-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: var(--warning-color);
        }

        .item-count {
            font-size: 0.9rem;
            font-weight: bold;
        }

        .item-rarity {
            position: absolute;
            top: 5px;
            left: 5px;
            font-size: 0.7rem;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .rarity-common { background: #808080; }
        .rarity-uncommon { background: #228B22; }
        .rarity-rare { background: #1E90FF; }
        .rarity-epic { background: #8A2BE2; }
        .rarity-legendary { background: #FFD700; color: #000; }

        .crafting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(61, 43, 31, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid var(--accent-color);
        }

        .craft-info {
            flex: 1;
        }

        .craft-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .craft-requirements {
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .craft-button {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
        }

        .craft-button:hover {
            background: #1f7a1f;
        }

        .craft-button:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .pvp-player {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(61, 43, 31, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid var(--accent-color);
        }

        .player-details {
            flex: 1;
        }

        .player-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .player-level {
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .attack-button {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
        }

        .attack-button:hover {
            background: #a00;
        }

        .admin-panel {
            background: rgba(139, 0, 0, 0.2);
            border: 2px solid var(--danger-color);
        }

        .admin-section {
            margin-bottom: 20px;
        }

        .admin-input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid var(--accent-color);
            background: rgba(61, 43, 31, 0.8);
            color: var(--light-color);
            font-family: 'Cinzel', serif;
        }

        .admin-button {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
            width: 100%;
            margin-bottom: 10px;
        }

        .admin-button:hover {
            background: #a00;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .skill-item {
            background: rgba(61, 43, 31, 0.8);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--accent-color);
        }

        .skill-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .skill-name {
            font-weight: bold;
        }

        .skill-level {
            color: var(--warning-color);
        }

        .skill-bar {
            height: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            overflow: hidden;
        }

        .skill-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 5px;
        }

        .upgrade-button {
            background: var(--info-color);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-size: 0.8rem;
            margin-top: 8px;
            width: 100%;
        }

        .upgrade-button:hover {
            background: #1a7ad9;
        }

        .upgrade-button:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .guild-section {
            background: rgba(61, 43, 31, 0.8);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--accent-color);
        }

        .guild-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .guild-members {
            margin-top: 15px;
        }

        .guild-member {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid var(--accent-color);
        }

        .join-guild-button {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            width: 100%;
            margin-top: 10px;
        }

        .join-guild-button:hover {
            background: #1f7a1f;
        }

        .market-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(61, 43, 31, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid var(--accent-color);
        }

        .market-info {
            flex: 1;
        }

        .market-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .market-price {
            font-size: 0.8rem;
            color: var(--warning-color);
        }

        .buy-button {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
        }

        .buy-button:hover {
            background: #1f7a1f;
        }

        .buy-button:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .sell-section {
            margin-top: 20px;
            padding: 15px;
            background: rgba(61, 43, 31, 0.8);
            border-radius: 8px;
            border: 1px solid var(--accent-color);
        }

        .sell-form {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .sell-select, .sell-input, .sell-button {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid var(--accent-color);
            background: rgba(41, 29, 19, 0.8);
            color: var(--light-color);
            font-family: 'Cinzel', serif;
        }

        .sell-button {
            background: var(--secondary-color);
            cursor: pointer;
            font-weight: bold;
        }

        .sell-button:hover {
            background: var(--accent-color);
        }

        .player-market-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(61, 43, 31, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid var(--accent-color);
        }

        .player-market-info {
            flex: 1;
        }

        .player-market-seller {
            font-size: 0.8rem;
            color: var(--accent-color);
            margin-bottom: 3px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            animation: slideIn 0.5s;
            max-width: 300px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
            border-radius: 10px;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            border: 2px solid var(--secondary-color);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.7);
            text-align: center;
        }

        .modal-title {
            font-family: 'MedievalSharp', cursive;
            font-size: 1.8rem;
            color: var(--warning-color);
            margin-bottom: 15px;
        }

        .modal-text {
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .modal-button {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
        }

        .modal-button:hover {
            background: var(--accent-color);
        }

        .modal-button.primary {
            background: var(--success-color);
        }

        .modal-button.danger {
            background: var(--danger-color);
        }

        .login-form {
            max-width: 400px;
            margin: 50px auto;
            background: rgba(61, 43, 31, 0.9);
            padding: 30px;
            border-radius: 10px;
            border: 2px solid var(--secondary-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        .login-title {
            font-family: 'UnifrakturMaguntia', cursive;
            font-size: 2.2rem;
            color: var(--warning-color);
            text-align: center;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border-radius: 5px;
            border: 1px solid var(--accent-color);
            background: rgba(41, 29, 19, 0.8);
            color: var(--light-color);
            font-family: 'Cinzel', serif;
        }

        .login-button {
            width: 100%;
            background: var(--success-color);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 1.1rem;
        }

        .login-button:hover {
            background: #1f7a1f;
        }

        .register-link {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        .register-link a {
            color: var(--warning-color);
            text-decoration: none;
        }

        .register-link a:hover {
            text-decoration: underline;
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background: rgba(61, 43, 31, 0.8);
            border-radius: 8px;
            border: 1px solid var(--accent-color);
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .stat-item {
            background: rgba(210, 105, 30, 0.2);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--warning-color);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .online-players {
            background: rgba(61, 43, 31, 0.8);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--accent-color);
        }

        .online-players-title {
            font-size: 1rem;
            margin-bottom: 8px;
            color: var(--warning-color);
        }

        .online-players-list {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .online-player {
            background: rgba(139, 69, 19, 0.5);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .chat-container {
            background: rgba(61, 43, 31, 0.8);
            border-radius: 8px;
            border: 1px solid var(--accent-color);
            margin-top: 15px;
            max-height: 300px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            max-height: 200px;
        }

        .chat-message {
            margin-bottom: 8px;
            padding: 5px;
            border-radius: 5px;
            background: rgba(139, 69, 19, 0.3);
        }

        .chat-sender {
            font-weight: bold;
            color: var(--warning-color);
        }

        .chat-input-container {
            display: flex;
            padding: 10px;
            border-top: 1px solid var(--accent-color);
        }

        .chat-input {
            flex: 1;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid var(--accent-color);
            background: rgba(41, 29, 19, 0.8);
            color: var(--light-color);
            font-family: 'Cinzel', serif;
        }

        .chat-send {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 5px;
            font-family: 'Cinzel', serif;
        }

        @media (max-width: 600px) {
            .action-grid {
                grid-template-columns: 1fr;
            }
            
            .inventory-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .skills-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .game-title {
                font-size: 2rem;
            }
            
            .player-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .info-item {
                min-width: 100%;
            }
            
            .sell-form {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div id="notification" class="notification"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title" class="modal-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h2>
            <p id="modal-text" class="modal-text">–¢–µ–∫—Å—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞</p>
            <div class="modal-buttons">
                <button id="modal-button-ok" class="modal-button primary">OK</button>
                <button id="modal-button-cancel" class="modal-button">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
    <div id="login-screen" class="login-form">
        <h1 class="login-title">RPG Fantasy Online</h1>
        <div class="form-group">
            <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
            <input type="text" id="username" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" maxlength="20">
        </div>
        <div class="form-group">
            <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
            <input type="password" id="password" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
        </div>
        <button id="login-button" class="login-button">–í–æ–π—Ç–∏ –≤ –∏–≥—Ä—É</button>
        <div class="register-link">
            –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="register-link">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a> –≤ –±–æ—Ç–µ Telegram!
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–≥—Ä—ã -->
    <div id="game-screen" class="container" style="display: none;">
        <div class="header">
            <h1 class="game-title">RPG Fantasy Online</h1>
            <p>–ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –∂–¥–µ—Ç!</p>
        </div>

        <!-- –û–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–∏ -->
        <div class="online-players">
            <div class="online-players-title">–û–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–∏: <span id="online-count">1</span></div>
            <div class="online-players-list" id="online-players-list">
                <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <div class="player-info">
            <div class="info-item">
                <div class="info-label">–ò–≥—Ä–æ–∫</div>
                <div id="player-name" class="info-value">–ì–µ—Ä–æ–π</div>
            </div>
            <div class="info-item">
                <div class="info-label">–£—Ä–æ–≤–µ–Ω—å</div>
                <div id="player-level" class="info-value">1</div>
            </div>
            <div class="info-item">
                <div class="info-label">–ó–¥–æ—Ä–æ–≤—å–µ</div>
                <div id="player-health" class="info-value">100/100</div>
                <div class="progress-bar">
                    <div id="health-bar" class="progress-fill" style="width: 100%"></div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-label">–≠–Ω–µ—Ä–≥–∏—è</div>
                <div id="player-energy" class="info-value">100/100</div>
                <div class="progress-bar">
                    <div id="energy-bar" class="progress-fill" style="width: 100%"></div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-label">–û–ø—ã—Ç</div>
                <div id="player-exp" class="info-value">0/100</div>
                <div class="progress-bar">
                    <div id="exp-bar" class="progress-fill" style="width: 0%"></div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-label">–ó–æ–ª–æ—Ç–æ</div>
                <div id="player-gold" class="info-value">50</div>
            </div>
        </div>

        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="actions">–î–µ–π—Å—Ç–≤–∏—è</div>
            <div class="nav-tab" data-tab="inventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
            <div class="nav-tab" data-tab="crafting">–ö—Ä–∞—Ñ—Ç</div>
            <div class="nav-tab" data-tab="skills">–ù–∞–≤—ã–∫–∏</div>
            <div class="nav-tab" data-tab="pvp">PvP –ê—Ä–µ–Ω–∞</div>
            <div class="nav-tab" data-tab="market">–†—ã–Ω–æ–∫</div>
            <div class="nav-tab" data-tab="guild">–ì–∏–ª—å–¥–∏—è</div>
            <div class="nav-tab" data-tab="chat">–ß–∞—Ç</div>
            <div class="nav-tab admin-tab" data-tab="admin" style="display: none;">–ê–¥–º–∏–Ω</div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –î–µ–π—Å—Ç–≤–∏—è -->
        <div id="actions-tab" class="tab-content active">
            <h2 class="section-title">–î–µ–π—Å—Ç–≤–∏—è</h2>
            <div class="action-grid">
                <div class="action-card" data-action="hunt">
                    <div class="energy-cost">10</div>
                    <div class="action-icon">‚öîÔ∏è</div>
                    <div class="action-name">–û—Ö–æ—Ç–∞</div>
                    <div class="action-desc">–û—Ö–æ—Ç–∏—Ç—å—Å—è –Ω–∞ –º–æ–Ω—Å—Ç—Ä–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–ø—ã—Ç–∞ –∏ –∑–æ–ª–æ—Ç–∞</div>
                    <div class="cooldown" id="hunt-cooldown"></div>
                </div>
                <div class="action-card" data-action="mine">
                    <div class="energy-cost">8</div>
                    <div class="action-icon">‚õèÔ∏è</div>
                    <div class="action-name">–î–æ–±—ã—á–∞ —Ä—É–¥—ã</div>
                    <div class="action-desc">–î–æ–±—ã–≤–∞—Ç—å —Ä—É–¥—É –¥–ª—è –∫—Ä–∞—Ñ—Ç–∞</div>
                    <div class="cooldown" id="mine-cooldown"></div>
                </div>
                <div class="action-card" data-action="fish">
                    <div class="energy-cost">7</div>
                    <div class="action-icon">üé£</div>
                    <div class="action-name">–†—ã–±–∞–ª–∫–∞</div>
                    <div class="action-desc">–õ–æ–≤–∏—Ç—å —Ä—ã–±—É –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –µ–¥—ã</div>
                    <div class="cooldown" id="fish-cooldown"></div>
                </div>
                <div class="action-card" data-action="train">
                    <div class="energy-cost">15</div>
                    <div class="action-icon">üí™</div>
                    <div class="action-name">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</div>
                    <div class="action-desc">–£–≤–µ–ª–∏—á–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</div>
                    <div class="cooldown" id="train-cooldown"></div>
                </div>
                <div class="action-card" data-action="quest">
                    <div class="energy-cost">20</div>
                    <div class="action-icon">üìú</div>
                    <div class="action-name">–ó–∞–¥–∞–Ω–∏–µ</div>
                    <div class="action-desc">–í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –Ω–∞–≥—Ä–∞–¥—ã</div>
                    <div class="cooldown" id="quest-cooldown"></div>
                </div>
                <div class="action-card" data-action="bonus">
                    <div class="energy-cost">0</div>
                    <div class="action-icon">üéÅ</div>
                    <div class="action-name">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å</div>
                    <div class="action-desc">–ü–æ–ª—É—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É</div>
                    <div class="cooldown" id="bonus-cooldown"></div>
                </div>
                <div class="action-card" data-action="dungeon">
                    <div class="energy-cost">25</div>
                    <div class="action-icon">üè∞</div>
                    <div class="action-name">–ü–æ–¥–∑–µ–º–µ–ª—å–µ</div>
                    <div class="action-desc">–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø–æ–¥–∑–µ–º–µ–ª—å–µ –¥–ª—è —Ä–µ–¥–∫–∏—Ö –Ω–∞–≥—Ä–∞–¥</div>
                    <div class="cooldown" id="dungeon-cooldown"></div>
                </div>
                <div class="action-card" data-action="rest">
                    <div class="energy-cost">-30</div>
                    <div class="action-icon">üõå</div>
                    <div class="action-name">–û—Ç–¥—ã—Ö</div>
                    <div class="action-desc">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –∏ —ç–Ω–µ—Ä–≥–∏—é</div>
                    <div class="cooldown" id="rest-cooldown"></div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
        <div id="inventory-tab" class="tab-content">
            <h2 class="section-title">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="total-items">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="inventory-value">0</div>
                    <div class="stat-label">–°—Ç–æ–∏–º–æ—Å—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="equipped-items">0</div>
                    <div class="stat-label">–≠–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–æ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="inventory-space">50/50</div>
                    <div class="stat-label">–°–≤–æ–±–æ–¥–Ω–æ –º–µ—Å—Ç–∞</div>
                </div>
            </div>
            <div class="inventory-grid" id="inventory-grid">
                <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ö—Ä–∞—Ñ—Ç -->
        <div id="crafting-tab" class="tab-content">
            <h2 class="section-title">–ö—Ä–∞—Ñ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤</h2>
            <div id="crafting-list">
                <!-- –°–ø–∏—Å–æ–∫ –∫—Ä–∞—Ñ—Ç–∞ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ù–∞–≤—ã–∫–∏ -->
        <div id="skills-tab" class="tab-content">
            <h2 class="section-title">–ù–∞–≤—ã–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h2>
            <div class="skills-grid">
                <div class="skill-item">
                    <div class="skill-header">
                        <div class="skill-name">–°–∏–ª–∞</div>
                        <div class="skill-level">–£—Ä. <span id="strength-level">1</span></div>
                    </div>
                    <div class="skill-bar">
                        <div id="strength-bar" class="skill-fill" style="width: 0%"></div>
                    </div>
                    <button class="upgrade-button" data-skill="strength">–£–ª—É—á—à–∏—Ç—å (10 –∑–æ–ª–æ—Ç–∞)</button>
                </div>
                <div class="skill-item">
                    <div class="skill-header">
                        <div class="skill-name">–õ–æ–≤–∫–æ—Å—Ç—å</div>
                        <div class="skill-level">–£—Ä. <span id="agility-level">1</span></div>
                    </div>
                    <div class="skill-bar">
                        <div id="agility-bar" class="skill-fill" style="width: 0%"></div>
                    </div>
                    <button class="upgrade-button" data-skill="agility">–£–ª—É—á—à–∏—Ç—å (10 –∑–æ–ª–æ—Ç–∞)</button>
                </div>
                <div class="skill-item">
                    <div class="skill-header">
                        <div class="skill-name">–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç</div>
                        <div class="skill-level">–£—Ä. <span id="intelligence-level">1</span></div>
                    </div>
                    <div class="skill-bar">
                        <div id="intelligence-bar" class="skill-fill" style="width: 0%"></div>
                    </div>
                    <button class="upgrade-button" data-skill="intelligence">–£–ª—É—á—à–∏—Ç—å (10 –∑–æ–ª–æ—Ç–∞)</button>
                </div>
                <div class="skill-item">
                    <div class="skill-header">
                        <div class="skill-name">–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å</div>
                        <div class="skill-level">–£—Ä. <span id="stamina-level">1</span></div>
                    </div>
                    <div class="skill-bar">
                        <div id="stamina-bar" class="skill-fill" style="width: 0%"></div>
                    </div>
                    <button class="upgrade-button" data-skill="stamina">–£–ª—É—á—à–∏—Ç—å (10 –∑–æ–ª–æ—Ç–∞)</button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ PvP –ê—Ä–µ–Ω–∞ -->
        <div id="pvp-tab" class="tab-content">
            <h2 class="section-title">PvP –ê—Ä–µ–Ω–∞</h2>
            <div id="pvp-players-list">
                <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è PvP –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –†—ã–Ω–æ–∫ -->
        <div id="market-tab" class="tab-content">
            <h2 class="section-title">–†—ã–Ω–æ–∫</h2>
            <div id="market-items-list">
                <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Ä—ã–Ω–∫–µ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="sell-section">
                <h3>–ü—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç</h3>
                <div class="sell-form">
                    <select id="sell-item-select" class="sell-select">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</option>
                    </select>
                    <input type="number" id="sell-price" class="sell-input" placeholder="–¶–µ–Ω–∞" min="1" max="10000">
                    <button id="sell-button" class="sell-button">–í—ã—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∂—É</button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ì–∏–ª—å–¥–∏—è -->
        <div id="guild-tab" class="tab-content">
            <h2 class="section-title">–ì–∏–ª—å–¥–∏—è</h2>
            <div class="guild-section">
                <div class="guild-info">
                    <div>
                        <div>–ù–∞–∑–≤–∞–Ω–∏–µ: <span id="guild-name">–ù–µ –≤ –≥–∏–ª—å–¥–∏–∏</span></div>
                        <div>–£—Ä–æ–≤–µ–Ω—å: <span id="guild-level">-</span></div>
                    </div>
                    <div>
                        <div>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: <span id="guild-members-count">-</span></div>
                        <div>–û–ø—ã—Ç: <span id="guild-exp">-</span></div>
                    </div>
                </div>
                <button id="join-guild-button" class="join-guild-button">–í—Å—Ç—É–ø–∏—Ç—å –≤ –≥–∏–ª—å–¥–∏—é</button>
            </div>
            <div class="guild-members">
                <h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥–∏–ª—å–¥–∏–∏</h3>
                <div id="guild-members-list">
                    <!-- –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥–∏–ª—å–¥–∏–∏ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ß–∞—Ç -->
        <div id="chat-tab" class="tab-content">
            <h2 class="section-title">–û–±—â–∏–π —á–∞—Ç</h2>
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages">
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                <div class="chat-input-container">
                    <input type="text" id="chat-input" class="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="200">
                    <button id="chat-send" class="chat-send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
        <div id="admin-tab" class="tab-content admin-panel">
            <h2 class="section-title">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
            <div class="admin-section">
                <h3>–í—ã–¥–∞—á–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤</h3>
                <input type="text" id="admin-username" class="admin-input" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                <select id="admin-item" class="admin-input">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</option>
                    <option value="sword">–ú–µ—á (–û–±—ã—á–Ω—ã–π)</option>
                    <option value="axe">–¢–æ–ø–æ—Ä (–ù–µ–æ–±—ã—á–Ω—ã–π)</option>
                    <option value="bow">–õ—É–∫ (–†–µ–¥–∫–∏–π)</option>
                    <option value="staff">–ü–æ—Å–æ—Ö (–≠–ø–∏—á–µ—Å–∫–∏–π)</option>
                    <option value="shield">–©–∏—Ç (–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π)</option>
                    <option value="potion_health">–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è</option>
                    <option value="potion_energy">–ó–µ–ª—å–µ —ç–Ω–µ—Ä–≥–∏–∏</option>
                    <option value="gold">–ó–æ–ª–æ—Ç–æ</option>
                </select>
                <input type="number" id="admin-amount" class="admin-input" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" min="1" max="1000" value="1">
                <button id="admin-give-item" class="admin-button">–í—ã–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç</button>
            </div>
            <div class="admin-section">
                <h3>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</h3>
                <input type="text" id="admin-stats-username" class="admin-input" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                <input type="number" id="admin-level" class="admin-input" placeholder="–£—Ä–æ–≤–µ–Ω—å" min="1" max="100">
                <input type="number" id="admin-gold" class="admin-input" placeholder="–ó–æ–ª–æ—Ç–æ" min="0" max="1000000">
                <input type="number" id="admin-health" class="admin-input" placeholder="–ó–¥–æ—Ä–æ–≤—å–µ" min="1" max="1000">
                <input type="number" id="admin-energy" class="admin-input" placeholder="–≠–Ω–µ—Ä–≥–∏—è" min="1" max="1000">
                <button id="admin-set-stats" class="admin-button">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</button>
            </div>
            <div class="admin-section">
                <h3>–°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                <button id="admin-reset-cooldowns" class="admin-button">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –∫—É–ª–¥–∞—É–Ω—ã</button>
                <button id="admin-broadcast" class="admin-button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Å–µ–º</button>
            </div>
        </div>

        <div class="footer">
            RPG Fantasy Online v2.0 | –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è RPG —Å —Ä—ã–Ω–∫–æ–º –∏ PvP
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameState = {
            player: {
                username: '',
                level: 1,
                exp: 0,
                expToNextLevel: 100,
                health: 100,
                maxHealth: 100,
                energy: 100,
                maxEnergy: 100,
                gold: 50,
                strength: 1,
                agility: 1,
                intelligence: 1,
                stamina: 1,
                inventory: [],
                skills: {},
                cooldowns: {},
                lastDailyBonus: null,
                guild: null,
                isAdmin: false
            },
            onlinePlayers: [],
            marketItems: [],
            guilds: [],
            chatMessages: []
        };

        // –≠–º—É–ª—è—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –±—É–¥–µ—Ç —Å–µ—Ä–≤–µ—Ä)
        const mockDatabase = {
            users: {},
            market: [],
            guilds: [],
            chat: []
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            const savedUser = localStorage.getItem('rpgPlayer');
            if (savedUser) {
                try {
                    const userData = JSON.parse(savedUser);
                    loginUser(userData.username);
                } catch (e) {
                    showLoginScreen();
                }
            } else {
                showLoginScreen();
            }

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
            setInterval(gameLoop, 1000);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
            setInterval(updateOnlinePlayers, 5000);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞
            setInterval(updateMarket, 10000);
        });

        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞
        function showLoginScreen() {
            document.getElementById('login-screen').style.display = 'block';
            document.getElementById('game-screen').style.display = 'none';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω
        function showGameScreen() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
        }

        // –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loginUser(username) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            gameState.player.username = username;
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–∞ (—ç–º—É–ª—è—Ü–∏—è)
            if (mockDatabase.users[username]) {
                gameState.player = { ...gameState.player, ...mockDatabase.users[username] };
            } else {
                // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                mockDatabase.users[username] = { ...gameState.player };
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –≤ –æ–Ω–ª–∞–π–Ω
            if (!gameState.onlinePlayers.includes(username)) {
                gameState.onlinePlayers.push(username);
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–ø—Ä–æ—Å—Ç–∞—è —ç–º—É–ª—è—Ü–∏—è)
            if (username === 'admin' || username === 'moderator') {
                gameState.player.isAdmin = true;
                document.querySelectorAll('.admin-tab').forEach(el => el.style.display = 'flex');
            }
            
            showGameScreen();
            updateUI();
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}!`);
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞
            document.getElementById('login-button').addEventListener('click', function() {
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value;
                
                if (username.length < 3) {
                    showNotification('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞');
                    return;
                }
                
                if (password.length < 1) {
                    showNotification('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å');
                    return;
                }
                
                loginUser(username);
            });
            
            // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Å—ã–ª–∫–µ
            document.getElementById('register-link').addEventListener('click', function(e) {
                e.preventDefault();
                showModal(
                    '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', 
                    '–î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—à–µ–≥–æ Telegram –±–æ—Ç–∞: @RpgFantasyBot', 
                    ['OK']
                );
            });
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // –î–µ–π—Å—Ç–≤–∏—è
            document.querySelectorAll('.action-card').forEach(card => {
                card.addEventListener('click', function() {
                    if (this.classList.contains('disabled')) return;
                    
                    const action = this.getAttribute('data-action');
                    performAction(action);
                });
            });
            
            // –£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞–≤—ã–∫–æ–≤
            document.querySelectorAll('.upgrade-button').forEach(button => {
                button.addEventListener('click', function() {
                    const skill = this.getAttribute('data-skill');
                    upgradeSkill(skill);
                });
            });
            
            // –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
            document.getElementById('sell-button').addEventListener('click', function() {
                sellItemOnMarket();
            });
            
            // –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –≥–∏–ª—å–¥–∏—é
            document.getElementById('join-guild-button').addEventListener('click', function() {
                joinGuild();
            });
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
            document.getElementById('chat-send').addEventListener('click', function() {
                sendChatMessage();
            });
            
            document.getElementById('chat-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendChatMessage();
                }
            });
            
            // –ê–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏
            document.getElementById('admin-give-item').addEventListener('click', function() {
                adminGiveItem();
            });
            
            document.getElementById('admin-set-stats').addEventListener('click', function() {
                adminSetStats();
            });
            
            document.getElementById('admin-reset-cooldowns').addEventListener('click', function() {
                adminResetCooldowns();
            });
            
            document.getElementById('admin-broadcast').addEventListener('click', function() {
                adminBroadcast();
            });
            
            // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            document.getElementById('modal-button-ok').addEventListener('click', function() {
                hideModal();
            });
            
            document.getElementById('modal-button-cancel').addEventListener('click', function() {
                hideModal();
            });
        }

        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function gameLoop() {
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
            if (gameState.player.energy < gameState.player.maxEnergy) {
                gameState.player.energy = Math.min(
                    gameState.player.maxEnergy, 
                    gameState.player.energy + 0.5
                );
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è
            if (gameState.player.health < gameState.player.maxHealth) {
                gameState.player.health = Math.min(
                    gameState.player.maxHealth, 
                    gameState.player.health + 0.2
                );
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É–ª–¥–∞—É–Ω–æ–≤
            updateCooldowns();
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            saveGameState();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateUI();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabId) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(`${tabId}-tab`).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É
            document.querySelector(`.nav-tab[data-tab="${tabId}"]`).classList.add('active');
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫
            if (tabId === 'market') {
                loadMarketItems();
                updateSellItemSelect();
            } else if (tabId === 'pvp') {
                loadPvPPlayers();
            } else if (tabId === 'guild') {
                loadGuildInfo();
            } else if (tabId === 'chat') {
                loadChatMessages();
            }
        }

        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
        function performAction(action) {
            const player = gameState.player;
            const energyCost = parseInt(document.querySelector(`.action-card[data-action="${action}"] .energy-cost`).textContent);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏
            if (player.energy < energyCost) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞
            if (player.cooldowns && player.cooldowns[action] > Date.now()) {
                showNotification('–î–µ–π—Å—Ç–≤–∏–µ –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤–æ!');
                return;
            }
            
            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
            let reward = {};
            let message = '';
            
            switch(action) {
                case 'hunt':
                    reward = {
                        exp: Math.floor(Math.random() * 10) + 5,
                        gold: Math.floor(Math.random() * 8) + 3,
                        items: [{
                            id: 'monster_claw',
                            name: '–ö–æ–≥–æ—Ç—å –º–æ–Ω—Å—Ç—Ä–∞',
                            rarity: 'uncommon',
                            value: 5
                        }]
                    };
                    message = '–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–æ—Ö–æ—Ç–∏–ª–∏—Å—å –∏ –ø–æ–ª—É—á–∏–ª–∏ –Ω–∞–≥—Ä–∞–¥—É!';
                    break;
                    
                case 'mine':
                    reward = {
                        exp: Math.floor(Math.random() * 8) + 3,
                        items: [{
                            id: 'iron_ore',
                            name: '–ñ–µ–ª–µ–∑–Ω–∞—è —Ä—É–¥–∞',
                            rarity: 'common',
                            value: 3
                        }, {
                            id: 'coal',
                            name: '–£–≥–æ–ª—å',
                            rarity: 'common',
                            value: 2
                        }]
                    };
                    message = '–í—ã –¥–æ–±—ã–ª–∏ –ø–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã!';
                    break;
                    
                case 'fish':
                    reward = {
                        exp: Math.floor(Math.random() * 6) + 2,
                        items: [{
                            id: 'fish',
                            name: '–†—ã–±–∞',
                            rarity: 'common',
                            value: 4
                        }]
                    };
                    message = '–£–ª–æ–≤ —É–¥–∞–ª—Å—è!';
                    break;
                    
                case 'train':
                    reward = {
                        exp: Math.floor(Math.random() * 12) + 8
                    };
                    // –°–ª—É—á–∞–π–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
                    const stats = ['strength', 'agility', 'intelligence', 'stamina'];
                    const randomStat = stats[Math.floor(Math.random() * stats.length)];
                    player[randomStat] += 0.1;
                    message = `–í—ã –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏ —É–ª—É—á—à–∏–ª–∏ ${getStatName(randomStat)}!`;
                    break;
                    
                case 'quest':
                    reward = {
                        exp: Math.floor(Math.random() * 20) + 15,
                        gold: Math.floor(Math.random() * 15) + 10,
                        items: [{
                            id: 'quest_reward',
                            name: '–ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –∑–∞–¥–∞–Ω–∏–µ',
                            rarity: 'rare',
                            value: 15
                        }]
                    };
                    message = '–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ü–æ–ª—É—á–µ–Ω–∞ –Ω–∞–≥—Ä–∞–¥–∞.';
                    break;
                    
                case 'bonus':
                    const today = new Date().toDateString();
                    if (player.lastDailyBonus === today) {
                        showNotification('–í—ã —É–∂–µ –ø–æ–ª—É—á–∞–ª–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å —Å–µ–≥–æ–¥–Ω—è!');
                        return;
                    }
                    
                    reward = {
                        gold: 25,
                        items: [{
                            id: 'daily_potion',
                            name: '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∑–µ–ª—å–µ',
                            rarity: 'uncommon',
                            value: 10
                        }]
                    };
                    player.lastDailyBonus = today;
                    message = '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å –ø–æ–ª—É—á–µ–Ω!';
                    break;
                    
                case 'dungeon':
                    reward = {
                        exp: Math.floor(Math.random() * 30) + 20,
                        gold: Math.floor(Math.random() * 25) + 15,
                        items: [{
                            id: 'dungeon_treasure',
                            name: '–°–æ–∫—Ä–æ–≤–∏—â–µ –ø–æ–¥–∑–µ–º–µ–ª—å—è',
                            rarity: 'epic',
                            value: 50
                        }]
                    };
                    message = '–ü–æ–¥–∑–µ–º–µ–ª—å–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–æ! –ù–∞–π–¥–µ–Ω—ã —Ü–µ–Ω–Ω—ã–µ —Ç—Ä–æ—Ñ–µ–∏.';
                    break;
                    
                case 'rest':
                    player.health = player.maxHealth;
                    player.energy = player.maxEnergy;
                    message = '–í—ã –æ—Ç–¥–æ—Ö–Ω—É–ª–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ —Å–∏–ª—ã!';
                    break;
            }
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã
            if (reward.exp) {
                player.exp += reward.exp;
                checkLevelUp();
            }
            
            if (reward.gold) {
                player.gold += reward.gold;
            }
            
            if (reward.items) {
                reward.items.forEach(item => {
                    addItemToInventory(item);
                });
            }
            
            // –†–∞—Å—Ö–æ–¥ —ç–Ω–µ—Ä–≥–∏–∏
            player.energy -= energyCost;
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞ (30 —Å–µ–∫—É–Ω–¥ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –¥–µ–π—Å—Ç–≤–∏–π)
            const cooldownTime = action === 'bonus' ? 24 * 60 * 60 * 1000 : 30 * 1000;
            if (!player.cooldowns) player.cooldowns = {};
            player.cooldowns[action] = Date.now() + cooldownTime;
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
            showNotification(message);
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
        function addItemToInventory(item) {
            const player = gameState.player;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            if (player.inventory.length >= 50) {
                showNotification('–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø–æ–ª–æ–Ω!');
                return false;
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞
            player.inventory.push({
                ...item,
                id: `${item.id}_${Date.now()}` // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
            });
            
            return true;
        }

        // –£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞–≤—ã–∫–∞
        function upgradeSkill(skill) {
            const player = gameState.player;
            const cost = 10;
            
            if (player.gold < cost) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è!');
                return;
            }
            
            player.gold -= cost;
            player[skill] += 1;
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è –ø—Ä–∏ —É–ª—É—á—à–µ–Ω–∏–∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏
            if (skill === 'stamina') {
                player.maxHealth += 10;
                player.health += 10;
            }
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏ –ø—Ä–∏ —É–ª—É—á—à–µ–Ω–∏–∏ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞
            if (skill === 'intelligence') {
                player.maxEnergy += 10;
                player.energy += 10;
            }
            
            showNotification(`–ù–∞–≤—ã–∫ "${getStatName(skill)}" —É–ª—É—á—à–µ–Ω –¥–æ —É—Ä–æ–≤–Ω—è ${player[skill]}!`);
            updateUI();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
        function checkLevelUp() {
            const player = gameState.player;
            
            while (player.exp >= player.expToNextLevel) {
                player.exp -= player.expToNextLevel;
                player.level += 1;
                player.expToNextLevel = Math.floor(player.expToNextLevel * 1.2);
                
                // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Ä–æ–≤–µ–Ω—å
                player.maxHealth += 10;
                player.health = player.maxHealth;
                player.maxEnergy += 5;
                player.energy = player.maxEnergy;
                player.gold += player.level * 5;
                
                showNotification(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ ${player.level} —É—Ä–æ–≤–Ω—è!`);
            }
        }

        // –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ –Ω–∞ —Ä—ã–Ω–∫–µ
        function sellItemOnMarket() {
            const itemSelect = document.getElementById('sell-item-select');
            const priceInput = document.getElementById('sell-price');
            
            const itemId = itemSelect.value;
            const price = parseInt(priceInput.value);
            
            if (!itemId) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏!');
                return;
            }
            
            if (!price || price < 1) {
                showNotification('–£–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É!');
                return;
            }
            
            // –ü–æ–∏—Å–∫ –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
            const player = gameState.player;
            const itemIndex = player.inventory.findIndex(item => item.id === itemId);
            
            if (itemIndex === -1) {
                showNotification('–ü—Ä–µ–¥–º–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ!');
                return;
            }
            
            const item = player.inventory[itemIndex];
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
            const marketItem = {
                id: `market_${Date.now()}`,
                item: item,
                seller: player.username,
                price: price,
                timestamp: Date.now()
            };
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ä—ã–Ω–æ–∫
            gameState.marketItems.push(marketItem);
            mockDatabase.market.push(marketItem);
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            player.inventory.splice(itemIndex, 1);
            
            showNotification(`–ü—Ä–µ–¥–º–µ—Ç "${item.name}" –≤—ã—Å—Ç–∞–≤–ª–µ–Ω –Ω–∞ —Ä—ã–Ω–æ–∫ –∑–∞ ${price} –∑–æ–ª–æ—Ç–∞!`);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateSellItemSelect();
            updateUI();
        }

        // –ü–æ–∫—É–ø–∫–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ —Å —Ä—ã–Ω–∫–∞
        function buyMarketItem(marketItemId) {
            const marketItem = gameState.marketItems.find(item => item.id === marketItemId);
            
            if (!marketItem) {
                showNotification('–ü—Ä–µ–¥–º–µ—Ç —É–∂–µ –ø—Ä–æ–¥–∞–Ω!');
                return;
            }
            
            const player = gameState.player;
            
            if (player.gold < marketItem.price) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏!');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
            if (player.inventory.length >= 50) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ!');
                return;
            }
            
            // –ü–æ–∫—É–ø–∫–∞
            player.gold -= marketItem.price;
            player.inventory.push(marketItem.item);
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —Å —Ä—ã–Ω–∫–∞
            const marketIndex = gameState.marketItems.findIndex(item => item.id === marketItemId);
            gameState.marketItems.splice(marketIndex, 1);
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            const dbIndex = mockDatabase.market.findIndex(item => item.id === marketItemId);
            if (dbIndex !== -1) {
                mockDatabase.market.splice(dbIndex, 1);
            }
            
            showNotification(`–í—ã –∫—É–ø–∏–ª–∏ "${marketItem.item.name}" –∑–∞ ${marketItem.price} –∑–æ–ª–æ—Ç–∞!`);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateUI();
        }

        // –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –≥–∏–ª—å–¥–∏—é
        function joinGuild() {
            const player = gameState.player;
            
            if (player.guild) {
                showNotification('–í—ã —É–∂–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –≥–∏–ª—å–¥–∏–∏!');
                return;
            }
            
            // –ü–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–Ω–æ–π –≥–∏–ª—å–¥–∏–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π
            let guild = gameState.guilds.find(g => g.members.length < 10);
            
            if (!guild) {
                guild = {
                    id: `guild_${Date.now()}`,
                    name: `–ì–∏–ª—å–¥–∏—è ${gameState.guilds.length + 1}`,
                    level: 1,
                    exp: 0,
                    members: []
                };
                gameState.guilds.push(guild);
                mockDatabase.guilds.push(guild);
            }
            
            // –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –≥–∏–ª—å–¥–∏—é
            guild.members.push({
                username: player.username,
                rank: 'member',
                joinDate: Date.now()
            });
            
            player.guild = guild.id;
            
            showNotification(`–í—ã –≤—Å—Ç—É–ø–∏–ª–∏ –≤ –≥–∏–ª—å–¥–∏—é "${guild.name}"!`);
            loadGuildInfo();
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            if (message.length > 200) {
                showNotification('–°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ!');
                return;
            }
            
            const chatMessage = {
                id: `chat_${Date.now()}`,
                username: gameState.player.username,
                message: message,
                timestamp: Date.now()
            };
            
            gameState.chatMessages.push(chatMessage);
            mockDatabase.chat.push(chatMessage);
            
            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
            if (gameState.chatMessages.length > 100) {
                gameState.chatMessages.shift();
            }
            
            input.value = '';
            loadChatMessages();
        }

        // –ê–¥–º–∏–Ω: –≤—ã–¥–∞—á–∞ –ø—Ä–µ–¥–º–µ—Ç–∞
        function adminGiveItem() {
            const username = document.getElementById('admin-username').value.trim();
            const itemId = document.getElementById('admin-item').value;
            const amount = parseInt(document.getElementById('admin-amount').value) || 1;
            
            if (!username || !itemId) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            showNotification(`–ü—Ä–µ–¥–º–µ—Ç –≤—ã–¥–∞–Ω –∏–≥—Ä–æ–∫—É ${username}`);
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π
            document.getElementById('admin-username').value = '';
            document.getElementById('admin-item').value = '';
            document.getElementById('admin-amount').value = '1';
        }

        // –ê–¥–º–∏–Ω: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
        function adminSetStats() {
            const username = document.getElementById('admin-stats-username').value.trim();
            const level = parseInt(document.getElementById('admin-level').value);
            const gold = parseInt(document.getElementById('admin-gold').value);
            const health = parseInt(document.getElementById('admin-health').value);
            const energy = parseInt(document.getElementById('admin-energy').value);
            
            if (!username) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!');
                return;
            }
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            showNotification(`–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞ ${username} –æ–±–Ω–æ–≤–ª–µ–Ω—ã`);
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π
            document.getElementById('admin-stats-username').value = '';
            document.getElementById('admin-level').value = '';
            document.getElementById('admin-gold').value = '';
            document.getElementById('admin-health').value = '';
            document.getElementById('admin-energy').value = '';
        }

        // –ê–¥–º–∏–Ω: —Å–±—Ä–æ—Å –∫—É–ª–¥–∞—É–Ω–æ–≤
        function adminResetCooldowns() {
            gameState.player.cooldowns = {};
            showNotification('–í—Å–µ –∫—É–ª–¥–∞—É–Ω—ã —Å–±—Ä–æ—à–µ–Ω—ã!');
        }

        // –ê–¥–º–∏–Ω: —Ä–∞—Å—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        function adminBroadcast() {
            showModal(
                '–†–∞—Å—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è',
                '–í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Ñ–æ—Ä–º–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—Å–µ–º –∏–≥—Ä–æ–∫–∞–º',
                ['OK']
            );
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            const player = gameState.player;
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            document.getElementById('player-name').textContent = player.username;
            document.getElementById('player-level').textContent = player.level;
            document.getElementById('player-health').textContent = `${Math.floor(player.health)}/${player.maxHealth}`;
            document.getElementById('player-energy').textContent = `${Math.floor(player.energy)}/${player.maxEnergy}`;
            document.getElementById('player-exp').textContent = `${Math.floor(player.exp)}/${player.expToNextLevel}`;
            document.getElementById('player-gold').textContent = player.gold;
            
            // –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã
            document.getElementById('health-bar').style.width = `${(player.health / player.maxHealth) * 100}%`;
            document.getElementById('energy-bar').style.width = `${(player.energy / player.maxEnergy) * 100}%`;
            document.getElementById('exp-bar').style.width = `${(player.exp / player.expToNextLevel) * 100}%`;
            
            // –ù–∞–≤—ã–∫–∏
            document.getElementById('strength-level').textContent = Math.floor(player.strength);
            document.getElementById('agility-level').textContent = Math.floor(player.agility);
            document.getElementById('intelligence-level').textContent = Math.floor(player.intelligence);
            document.getElementById('stamina-level').textContent = Math.floor(player.stamina);
            
            document.getElementById('strength-bar').style.width = `${(player.strength - Math.floor(player.strength)) * 100}%`;
            document.getElementById('agility-bar').style.width = `${(player.agility - Math.floor(player.agility)) * 100}%`;
            document.getElementById('intelligence-bar').style.width = `${(player.intelligence - Math.floor(player.intelligence)) * 100}%`;
            document.getElementById('stamina-bar').style.width = `${(player.stamina - Math.floor(player.stamina)) * 100}%`;
            
            // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
            updateInventory();
            
            // –ö—Ä–∞—Ñ—Ç
            updateCrafting();
            
            // –î–µ–π—Å—Ç–≤–∏—è (–∫—É–ª–¥–∞—É–Ω—ã)
            updateActionCooldowns();
            
            // –û–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–∏
            updateOnlinePlayersUI();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function updateInventory() {
            const player = gameState.player;
            const inventoryGrid = document.getElementById('inventory-grid');
            
            // –û—á–∏—Å—Ç–∫–∞ —Å–µ—Ç–∫–∏
            inventoryGrid.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏
            player.inventory.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.innerHTML = `
                    <div class="item-rarity rarity-${item.rarity}">${getRarityName(item.rarity)}</div>
                    <div class="item-icon">${getItemIcon(item.id)}</div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-count">${item.value} –∑–æ–ª–æ—Ç–∞</div>
                `;
                inventoryGrid.appendChild(itemElement);
            });
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            document.getElementById('total-items').textContent = player.inventory.length;
            document.getElementById('inventory-value').textContent = player.inventory.reduce((sum, item) => sum + item.value, 0);
            document.getElementById('equipped-items').textContent = '0'; // –í —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–µ—Ç —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏
            document.getElementById('inventory-space').textContent = `${player.inventory.length}/50`;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—Ä–∞—Ñ—Ç–∞
        function updateCrafting() {
            const craftingList = document.getElementById('crafting-list');
            
            // –ü—Ä–∏–º–µ—Ä—ã —Ä–µ—Ü–µ–ø—Ç–æ–≤ –∫—Ä–∞—Ñ—Ç–∞
            const recipes = [
                {
                    id: 'health_potion',
                    name: '–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è',
                    requirements: [
                        { item: 'herb', count: 3 },
                        { item: 'water', count: 1 }
                    ],
                    result: {
                        id: 'potion_health',
                        name: '–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è',
                        rarity: 'uncommon',
                        value: 15
                    }
                },
                {
                    id: 'iron_sword',
                    name: '–ñ–µ–ª–µ–∑–Ω—ã–π –º–µ—á',
                    requirements: [
                        { item: 'iron_ore', count: 5 },
                        { item: 'wood', count: 2 }
                    ],
                    result: {
                        id: 'sword_iron',
                        name: '–ñ–µ–ª–µ–∑–Ω—ã–π –º–µ—á',
                        rarity: 'uncommon',
                        value: 25
                    }
                }
            ];
            
            // –û—á–∏—Å—Ç–∫–∞ —Å–ø–∏—Å–∫–∞
            craftingList.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞–º–∏
            recipes.forEach(recipe => {
                const recipeElement = document.createElement('div');
                recipeElement.className = 'crafting-item';
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫—Ä–∞—Ñ—Ç–∞
                const player = gameState.player;
                const canCraft = recipe.requirements.every(req => {
                    const itemCount = player.inventory.filter(item => item.id.startsWith(req.item)).length;
                    return itemCount >= req.count;
                });
                
                recipeElement.innerHTML = `
                    <div class="craft-info">
                        <div class="craft-name">${recipe.name}</div>
                        <div class="craft-requirements">${recipe.requirements.map(req => `${req.count} ${getItemName(req.item)}`).join(', ')}</div>
                    </div>
                    <button class="craft-button" ${canCraft ? '' : 'disabled'}>–°–æ–∑–¥–∞—Ç—å</button>
                `;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫—Ä–∞—Ñ—Ç–∞
                const craftButton = recipeElement.querySelector('.craft-button');
                craftButton.addEventListener('click', function() {
                    if (!canCraft) return;
                    
                    // –£–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
                    recipe.requirements.forEach(req => {
                        for (let i = 0; i < req.count; i++) {
                            const itemIndex = player.inventory.findIndex(item => item.id.startsWith(req.item));
                            if (itemIndex !== -1) {
                                player.inventory.splice(itemIndex, 1);
                            }
                        }
                    });
                    
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                    addItemToInventory(recipe.result);
                    
                    showNotification(`–í—ã —Å–æ–∑–¥–∞–ª–∏: ${recipe.name}!`);
                    updateUI();
                });
                
                craftingList.appendChild(recipeElement);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É–ª–¥–∞—É–Ω–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π
        function updateActionCooldowns() {
            const player = gameState.player;
            const now = Date.now();
            
            document.querySelectorAll('.action-card').forEach(card => {
                const action = card.getAttribute('data-action');
                const cooldownElement = card.querySelector('.cooldown');
                
                if (player.cooldowns && player.cooldowns[action] > now) {
                    const remaining = Math.ceil((player.cooldowns[action] - now) / 1000);
                    cooldownElement.textContent = `${remaining}—Å`;
                    card.classList.add('disabled');
                } else {
                    cooldownElement.textContent = '';
                    card.classList.remove('disabled');
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏
                const energyCost = parseInt(card.querySelector('.energy-cost').textContent);
                if (player.energy < energyCost) {
                    card.classList.add('disabled');
                }
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
        function updateOnlinePlayers() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            // –≠–º—É–ª—è—Ü–∏—è: —Å–ª—É—á–∞–π–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
            const baseCount = 5 + Math.floor(Math.random() * 10);
            gameState.onlinePlayers = Array.from({ length: baseCount }, (_, i) => `–ò–≥—Ä–æ–∫${i + 1}`);
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ
            if (!gameState.onlinePlayers.includes(gameState.player.username)) {
                gameState.onlinePlayers.push(gameState.player.username);
            }
            
            updateOnlinePlayersUI();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
        function updateOnlinePlayersUI() {
            const onlineList = document.getElementById('online-players-list');
            const onlineCount = document.getElementById('online-count');
            
            onlineCount.textContent = gameState.onlinePlayers.length;
            
            // –û—á–∏—Å—Ç–∫–∞ —Å–ø–∏—Å–∫–∞
            onlineList.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
            gameState.onlinePlayers.forEach(username => {
                const playerElement = document.createElement('div');
                playerElement.className = 'online-player';
                playerElement.textContent = username;
                onlineList.appendChild(playerElement);
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —Ä—ã–Ω–∫–∞
        function loadMarketItems() {
            const marketList = document.getElementById('market-items-list');
            
            // –û—á–∏—Å—Ç–∫–∞ —Å–ø–∏—Å–∫–∞
            marketList.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏
            gameState.marketItems.forEach(marketItem => {
                const itemElement = document.createElement('div');
                itemElement.className = 'player-market-item';
                
                itemElement.innerHTML = `
                    <div class="player-market-info">
                        <div class="player-market-seller">–ü—Ä–æ–¥–∞–≤–µ—Ü: ${marketItem.seller}</div>
                        <div class="market-name">${marketItem.item.name}</div>
                        <div class="market-price">${marketItem.price} –∑–æ–ª–æ—Ç–∞</div>
                    </div>
                    <button class="buy-button" data-item="${marketItem.id}">–ö—É–ø–∏—Ç—å</button>
                `;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∫—É–ø–∫–∏
                const buyButton = itemElement.querySelector('.buy-button');
                buyButton.addEventListener('click', function() {
                    const itemId = this.getAttribute('data-item');
                    buyMarketItem(itemId);
                });
                
                marketList.appendChild(itemElement);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞
        function updateMarket() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            // –≠–º—É–ª—è—Ü–∏—è: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –Ω–∞ —Ä—ã–Ω–æ–∫
            if (Math.random() < 0.3 && gameState.marketItems.length < 20) {
                const items = [
                    { id: 'wood', name: '–î–µ—Ä–µ–≤–æ', rarity: 'common', value: 2 },
                    { id: 'stone', name: '–ö–∞–º–µ–Ω—å', rarity: 'common', value: 3 },
                    { id: 'herb', name: '–¢—Ä–∞–≤–∞', rarity: 'common', value: 4 },
                    { id: 'iron_ore', name: '–ñ–µ–ª–µ–∑–Ω–∞—è —Ä—É–¥–∞', rarity: 'uncommon', value: 5 }
                ];
                
                const randomItem = items[Math.floor(Math.random() * items.length)];
                const randomPrice = randomItem.value + Math.floor(Math.random() * 5) + 1;
                const randomSeller = gameState.onlinePlayers[Math.floor(Math.random() * gameState.onlinePlayers.length)];
                
                const marketItem = {
                    id: `market_${Date.now()}`,
                    item: { ...randomItem, id: `${randomItem.id}_${Date.now()}` },
                    seller: randomSeller,
                    price: randomPrice,
                    timestamp: Date.now()
                };
                
                gameState.marketItems.push(marketItem);
                mockDatabase.market.push(marketItem);
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞ –≤–∫–ª–∞–¥–∫–∞ —Ä—ã–Ω–∫–∞
            if (document.getElementById('market-tab').classList.contains('active')) {
                loadMarketItems();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è PvP
        function loadPvPPlayers() {
            const pvpList = document.getElementById('pvp-players-list');
            
            // –û—á–∏—Å—Ç–∫–∞ —Å–ø–∏—Å–∫–∞
            pvpList.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏ (–∫—Ä–æ–º–µ —Ç–µ–∫—É—â–µ–≥–æ)
            gameState.onlinePlayers.forEach(username => {
                if (username === gameState.player.username) return;
                
                const playerElement = document.createElement('div');
                playerElement.className = 'pvp-player';
                
                // –°–ª—É—á–∞–π–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                const randomLevel = 1 + Math.floor(Math.random() * 10);
                
                playerElement.innerHTML = `
                    <div class="player-details">
                        <div class="player-name">${username}</div>
                        <div class="player-level">–£—Ä–æ–≤–µ–Ω—å ${randomLevel}</div>
                    </div>
                    <button class="attack-button" data-target="${username}">–ê—Ç–∞–∫–æ–≤–∞—Ç—å</button>
                `;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—Ç–∞–∫–∏
                const attackButton = playerElement.querySelector('.attack-button');
                attackButton.addEventListener('click', function() {
                    const target = this.getAttribute('data-target');
                    attackPlayer(target);
                });
                
                pvpList.appendChild(playerElement);
            });
        }

        // –ê—Ç–∞–∫–∞ –∏–≥—Ä–æ–∫–∞ –≤ PvP
        function attackPlayer(target) {
            const player = gameState.player;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏
            if (player.energy < 15) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –∞—Ç–∞–∫–∏!');
                return;
            }
            
            // –†–∞—Å—Ö–æ–¥ —ç–Ω–µ—Ä–≥–∏–∏
            player.energy -= 15;
            
            // –†–∞—Å—á–µ—Ç —É—Ä–æ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            const damage = Math.floor(player.strength * 5 + player.agility * 3);
            
            // –®–∞–Ω—Å —É—Å–ø–µ—Ö–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ª–æ–≤–∫–æ—Å—Ç–∏)
            const successChance = 0.5 + (player.agility / 100);
            const isSuccess = Math.random() < successChance;
            
            if (isSuccess) {
                // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Å–ø–µ—à–Ω—É—é –∞—Ç–∞–∫—É
                const expGain = Math.floor(damage / 2);
                const goldGain = Math.floor(damage / 5);
                
                player.exp += expGain;
                player.gold += goldGain;
                
                checkLevelUp();
                
                showNotification(`–í—ã —É—Å–ø–µ—à–Ω–æ –∞—Ç–∞–∫–æ–≤–∞–ª–∏ ${target} –∏ –Ω–∞–Ω–µ—Å–ª–∏ ${damage} —É—Ä–æ–Ω–∞! –ü–æ–ª—É—á–µ–Ω–æ: ${expGain} –æ–ø—ã—Ç–∞, ${goldGain} –∑–æ–ª–æ—Ç–∞.`);
            } else {
                showNotification(`–í—ã –ø—Ä–æ–º–∞—Ö–Ω—É–ª–∏—Å—å –ø—Ä–∏ –∞—Ç–∞–∫–µ ${target}!`);
            }
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞
            if (!player.cooldowns) player.cooldowns = {};
            player.cooldowns['pvp'] = Date.now() + 60 * 1000; // 1 –º–∏–Ω—É—Ç–∞
            
            updateUI();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥–∏–ª—å–¥–∏–∏
        function loadGuildInfo() {
            const player = gameState.player;
            
            if (player.guild) {
                const guild = gameState.guilds.find(g => g.id === player.guild);
                
                if (guild) {
                    document.getElementById('guild-name').textContent = guild.name;
                    document.getElementById('guild-level').textContent = guild.level;
                    document.getElementById('guild-members-count').textContent = `${guild.members.length}/10`;
                    document.getElementById('guild-exp').textContent = guild.exp;
                    
                    // –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
                    const membersList = document.getElementById('guild-members-list');
                    membersList.innerHTML = '';
                    
                    guild.members.forEach(member => {
                        const memberElement = document.createElement('div');
                        memberElement.className = 'guild-member';
                        memberElement.innerHTML = `
                            <div>${member.username}</div>
                            <div>${member.rank}</div>
                        `;
                        membersList.appendChild(memberElement);
                    });
                    
                    document.getElementById('join-guild-button').textContent = '–ü–æ–∫–∏–Ω—É—Ç—å –≥–∏–ª—å–¥–∏—é';
                    document.getElementById('join-guild-button').onclick = leaveGuild;
                    
                    return;
                }
            }
            
            // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –Ω–µ –≤ –≥–∏–ª—å–¥–∏–∏
            document.getElementById('guild-name').textContent = '–ù–µ –≤ –≥–∏–ª—å–¥–∏–∏';
            document.getElementById('guild-level').textContent = '-';
            document.getElementById('guild-members-count').textContent = '-';
            document.getElementById('guild-exp').textContent = '-';
            
            document.getElementById('guild-members-list').innerHTML = '';
            document.getElementById('join-guild-button').textContent = '–í—Å—Ç—É–ø–∏—Ç—å –≤ –≥–∏–ª—å–¥–∏—é';
            document.getElementById('join-guild-button').onclick = joinGuild;
        }

        // –í—ã—Ö–æ–¥ –∏–∑ –≥–∏–ª—å–¥–∏–∏
        function leaveGuild() {
            const player = gameState.player;
            
            if (!player.guild) {
                showNotification('–í—ã –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –≥–∏–ª—å–¥–∏–∏!');
                return;
            }
            
            const guild = gameState.guilds.find(g => g.id === player.guild);
            
            if (guild) {
                const memberIndex = guild.members.findIndex(m => m.username === player.username);
                if (memberIndex !== -1) {
                    guild.members.splice(memberIndex, 1);
                }
                
                // –£–¥–∞–ª–µ–Ω–∏–µ –≥–∏–ª—å–¥–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ –ø—É—Å—Ç–∞
                if (guild.members.length === 0) {
                    const guildIndex = gameState.guilds.findIndex(g => g.id === player.guild);
                    gameState.guilds.splice(guildIndex, 1);
                }
            }
            
            player.guild = null;
            showNotification('–í—ã –ø–æ–∫–∏–Ω—É–ª–∏ –≥–∏–ª—å–¥–∏—é!');
            loadGuildInfo();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
        function loadChatMessages() {
            const chatMessages = document.getElementById('chat-messages');
            
            // –û—á–∏—Å—Ç–∫–∞ —á–∞—Ç–∞
            chatMessages.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
            gameState.chatMessages.forEach(msg => {
                const messageElement = document.createElement('div');
                messageElement.className = 'chat-message';
                
                const time = new Date(msg.timestamp).toLocaleTimeString();
                
                messageElement.innerHTML = `
                    <div><span class="chat-sender">${msg.username}:</span> ${msg.message}</div>
                    <div style="font-size: 0.7rem; color: var(--accent-color);">${time}</div>
                `;
                
                chatMessages.appendChild(messageElement);
            });
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
        function updateSellItemSelect() {
            const player = gameState.player;
            const select = document.getElementById('sell-item-select');
            
            // –û—á–∏—Å—Ç–∫–∞ select
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</option>';
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            player.inventory.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.textContent = `${item.name} (${item.value} –∑–æ–ª–æ—Ç–∞)`;
                select.appendChild(option);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É–ª–¥–∞—É–Ω–æ–≤
        function updateCooldowns() {
            const player = gameState.player;
            const now = Date.now();
            
            if (player.cooldowns) {
                Object.keys(player.cooldowns).forEach(action => {
                    if (player.cooldowns[action] <= now) {
                        delete player.cooldowns[action];
                    }
                });
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
        function saveGameState() {
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
            localStorage.setItem('rpgPlayer', JSON.stringify(gameState.player));
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ "–±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"
            mockDatabase.users[gameState.player.username] = { ...gameState.player };
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            // –¶–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            if (type === 'error') {
                notification.style.background = 'var(--danger-color)';
            } else if (type === 'success') {
                notification.style.background = 'var(--success-color)';
            } else if (type === 'warning') {
                notification.style.background = 'var(--warning-color)';
                notification.style.color = '#000';
            } else {
                notification.style.background = 'var(--info-color)';
            }
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        function showModal(title, text, buttons = ['OK']) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-text').textContent = text;
            
            const modalButtons = document.querySelector('.modal-buttons');
            modalButtons.innerHTML = '';
            
            buttons.forEach(buttonText => {
                const button = document.createElement('button');
                button.className = 'modal-button';
                button.textContent = buttonText;
                
                if (buttonText === 'OK') {
                    button.classList.add('primary');
                } else if (buttonText === '–£–¥–∞–ª–∏—Ç—å' || buttonText === '–û—Ç–º–µ–Ω–∞') {
                    button.classList.add('danger');
                }
                
                button.addEventListener('click', function() {
                    hideModal();
                });
                
                modalButtons.appendChild(button);
            });
            
            document.getElementById('modal').style.display = 'flex';
        }

        function hideModal() {
            document.getElementById('modal').style.display = 'none';
        }

        function getStatName(stat) {
            const names = {
                strength: '–°–∏–ª–∞',
                agility: '–õ–æ–≤–∫–æ—Å—Ç—å',
                intelligence: '–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç',
                stamina: '–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å'
            };
            return names[stat] || stat;
        }

        function getRarityName(rarity) {
            const names = {
                common: '–û–±—ã—á–Ω—ã–π',
                uncommon: '–ù–µ–æ–±—ã—á–Ω—ã–π',
                rare: '–†–µ–¥–∫–∏–π',
                epic: '–≠–ø–∏—á–µ—Å–∫–∏–π',
                legendary: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π'
            };
            return names[rarity] || rarity;
        }

        function getItemIcon(itemId) {
            const icons = {
                monster_claw: 'üêæ',
                iron_ore: '‚õèÔ∏è',
                coal: '‚ö´',
                fish: 'üêü',
                quest_reward: 'üèÜ',
                daily_potion: 'üß™',
                dungeon_treasure: 'üíé',
                herb: 'üåø',
                wood: 'ü™µ',
                stone: 'ü™®',
                water: 'üíß',
                potion_health: '‚ù§Ô∏è',
                sword_iron: '‚öîÔ∏è'
            };
            
            // –ü–æ–∏—Å–∫ –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É
            for (const key in icons) {
                if (itemId.startsWith(key)) {
                    return icons[key];
                }
            }
            
            return 'üì¶';
        }

        function getItemName(itemId) {
            const names = {
                monster_claw: '–ö–æ–≥–æ—Ç—å –º–æ–Ω—Å—Ç—Ä–∞',
                iron_ore: '–ñ–µ–ª–µ–∑–Ω–∞—è —Ä—É–¥–∞',
                coal: '–£–≥–æ–ª—å',
                fish: '–†—ã–±–∞',
                quest_reward: '–ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –∑–∞–¥–∞–Ω–∏–µ',
                daily_potion: '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∑–µ–ª—å–µ',
                dungeon_treasure: '–°–æ–∫—Ä–æ–≤–∏—â–µ –ø–æ–¥–∑–µ–º–µ–ª—å—è',
                herb: '–¢—Ä–∞–≤–∞',
                wood: '–î–µ—Ä–µ–≤–æ',
                stone: '–ö–∞–º–µ–Ω—å',
                water: '–í–æ–¥–∞',
                potion_health: '–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è',
                sword_iron: '–ñ–µ–ª–µ–∑–Ω—ã–π –º–µ—á'
            };
            
            // –ü–æ–∏—Å–∫ –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É
            for (const key in names) {
                if (itemId.startsWith(key)) {
                    return names[key];
                }
            }
            
            return '–ü—Ä–µ–¥–º–µ—Ç';
        }
    </script>
</body>
</html>