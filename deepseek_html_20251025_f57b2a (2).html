<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPG Fantasy Bot</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Cinzel:wght@400;700&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8B4513;
            --secondary-color: #D2691E;
            --accent-color: #CD853F;
            --dark-color: #3D2B1F;
            --light-color: #F5DEB3;
            --success-color: #228B22;
            --danger-color: #8B0000;
            --warning-color: #FFD700;
            --info-color: #1E90FF;
            --magic-color: #8A2BE2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cinzel', serif;
            background: url('https://images.unsplash.com/photo-1518709268805-4e9042af2176?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
            background-size: cover;
            color: var(--light-color);
            min-height: 100vh;
            padding: 10px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
            border-radius: 10px;
            border: 2px solid var(--secondary-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        .game-title {
            font-family: 'UnifrakturMaguntia', cursive;
            font-size: 2.5rem;
            color: var(--warning-color);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            margin-bottom: 5px;
        }

        .player-info {
            display: flex;
            justify-content: space-between;
            background: rgba(61, 43, 31, 0.8);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--accent-color);
            flex-wrap: wrap;
        }

        .info-item {
            text-align: center;
            flex: 1;
            min-width: 80px;
        }

        .info-label {
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .info-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--light-color);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), var(--warning-color));
            border-radius: 4px;
            transition: width 0.3s;
        }

        .nav-tabs {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background: rgba(61, 43, 31, 0.8);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--accent-color);
            flex-wrap: wrap;
        }

        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 12px 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            border-right: 1px solid var(--accent-color);
            min-width: 100px;
        }

        .nav-tab:last-child {
            border-right: none;
        }

        .nav-tab.active {
            background: var(--primary-color);
            color: var(--warning-color);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(139, 69, 19, 0.5);
        }

        .tab-content {
            display: none;
            background: rgba(61, 43, 31, 0.9);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--accent-color);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            min-height: 400px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .section-title {
            font-family: 'MedievalSharp', cursive;
            font-size: 1.5rem;
            color: var(--warning-color);
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 8px;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .action-card {
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid var(--accent-color);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .action-card.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .action-card.disabled:hover {
            transform: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
        }

        .action-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--warning-color);
        }

        .action-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .action-desc {
            font-size: 0.8rem;
            color: var(--light-color);
            opacity: 0.8;
        }

        .cooldown {
            margin-top: 8px;
            font-size: 0.7rem;
            color: var(--danger-color);
        }

        .energy-cost {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--magic-color);
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .inventory-item {
            background: rgba(210, 105, 30, 0.2);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            border: 1px solid var(--accent-color);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .inventory-item:hover {
            background: rgba(210, 105, 30, 0.4);
        }

        .item-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: var(--warning-color);
        }

        .item-count {
            font-size: 0.9rem;
            font-weight: bold;
        }

        .item-rarity {
            position: absolute;
            top: 5px;
            left: 5px;
            font-size: 0.7rem;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .rarity-common { background: #808080; }
        .rarity-uncommon { background: #228B22; }
        .rarity-rare { background: #1E90FF; }
        .rarity-epic { background: #8A2BE2; }
        .rarity-legendary { background: #FFD700; color: #000; }

        .crafting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(61, 43, 31, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid var(--accent-color);
        }

        .craft-info {
            flex: 1;
        }

        .craft-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .craft-requirements {
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .craft-button {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
        }

        .craft-button:hover {
            background: #1f7a1f;
        }

        .craft-button:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .pvp-player {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(61, 43, 31, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid var(--accent-color);
        }

        .player-details {
            flex: 1;
        }

        .player-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .player-level {
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .attack-button {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
        }

        .attack-button:hover {
            background: #a00;
        }

        .admin-panel {
            background: rgba(139, 0, 0, 0.2);
            border: 2px solid var(--danger-color);
        }

        .admin-section {
            margin-bottom: 20px;
        }

        .admin-input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid var(--accent-color);
            background: rgba(61, 43, 31, 0.8);
            color: var(--light-color);
            font-family: 'Cinzel', serif;
        }

        .admin-button {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
            width: 100%;
            margin-bottom: 10px;
        }

        .admin-button:hover {
            background: #a00;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .skill-item {
            background: rgba(61, 43, 31, 0.8);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--accent-color);
        }

        .skill-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .skill-name {
            font-weight: bold;
        }

        .skill-level {
            color: var(--warning-color);
        }

        .skill-bar {
            height: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            overflow: hidden;
        }

        .skill-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 5px;
        }

        .upgrade-button {
            background: var(--info-color);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-size: 0.8rem;
            margin-top: 8px;
            width: 100%;
        }

        .upgrade-button:hover {
            background: #1a7ad9;
        }

        .upgrade-button:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .guild-section {
            background: rgba(61, 43, 31, 0.8);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--accent-color);
        }

        .guild-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .guild-members {
            margin-top: 15px;
        }

        .guild-member {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid var(--accent-color);
        }

        .join-guild-button {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            width: 100%;
            margin-top: 10px;
        }

        .join-guild-button:hover {
            background: #1f7a1f;
        }

        .market-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(61, 43, 31, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid var(--accent-color);
        }

        .market-info {
            flex: 1;
        }

        .market-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .market-price {
            font-size: 0.8rem;
            color: var(--warning-color);
        }

        .buy-button {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
        }

        .buy-button:hover {
            background: #1f7a1f;
        }

        .buy-button:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            animation: slideIn 0.5s;
            max-width: 300px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
            border-radius: 10px;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            border: 2px solid var(--secondary-color);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.7);
            text-align: center;
        }

        .modal-title {
            font-family: 'MedievalSharp', cursive;
            font-size: 1.8rem;
            color: var(--warning-color);
            margin-bottom: 15px;
        }

        .modal-text {
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .modal-button {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
        }

        .modal-button:hover {
            background: var(--accent-color);
        }

        .modal-button.primary {
            background: var(--success-color);
        }

        .modal-button.danger {
            background: var(--danger-color);
        }

        .login-form {
            max-width: 400px;
            margin: 50px auto;
            background: rgba(61, 43, 31, 0.9);
            padding: 30px;
            border-radius: 10px;
            border: 2px solid var(--secondary-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        .login-title {
            font-family: 'UnifrakturMaguntia', cursive;
            font-size: 2.2rem;
            color: var(--warning-color);
            text-align: center;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border-radius: 5px;
            border: 1px solid var(--accent-color);
            background: rgba(41, 29, 19, 0.8);
            color: var(--light-color);
            font-family: 'Cinzel', serif;
        }

        .login-button {
            width: 100%;
            background: var(--success-color);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 1.1rem;
        }

        .login-button:hover {
            background: #1f7a1f;
        }

        .register-link {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        .register-link a {
            color: var(--warning-color);
            text-decoration: none;
        }

        .register-link a:hover {
            text-decoration: underline;
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background: rgba(61, 43, 31, 0.8);
            border-radius: 8px;
            border: 1px solid var(--accent-color);
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .stat-item {
            background: rgba(210, 105, 30, 0.2);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--warning-color);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .online-players {
            background: rgba(61, 43, 31, 0.8);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--accent-color);
        }

        .online-players-title {
            font-size: 1rem;
            margin-bottom: 8px;
            color: var(--warning-color);
        }

        .online-players-list {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .online-player {
            background: rgba(139, 69, 19, 0.5);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .chat-container {
            background: rgba(61, 43, 31, 0.8);
            border-radius: 8px;
            border: 1px solid var(--accent-color);
            margin-top: 15px;
            max-height: 300px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            max-height: 200px;
        }

        .chat-message {
            margin-bottom: 8px;
            padding: 5px;
            border-radius: 5px;
            background: rgba(139, 69, 19, 0.3);
        }

        .chat-sender {
            font-weight: bold;
            color: var(--warning-color);
        }

        .chat-input-container {
            display: flex;
            padding: 10px;
            border-top: 1px solid var(--accent-color);
        }

        .chat-input {
            flex: 1;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid var(--accent-color);
            background: rgba(41, 29, 19, 0.8);
            color: var(--light-color);
            font-family: 'Cinzel', serif;
        }

        .chat-send {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 5px;
            font-family: 'Cinzel', serif;
        }

        @media (max-width: 600px) {
            .action-grid {
                grid-template-columns: 1fr;
            }
            
            .inventory-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .skills-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .game-title {
                font-size: 2rem;
            }
            
            .player-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .info-item {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div id="notification" class="notification"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title" class="modal-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h2>
            <p id="modal-text" class="modal-text">–¢–µ–∫—Å—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞</p>
            <div class="modal-buttons">
                <button id="modal-button-ok" class="modal-button primary">OK</button>
                <button id="modal-button-cancel" class="modal-button">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
    <div id="login-screen" class="login-form">
        <h1 class="login-title">RPG Fantasy</h1>
        <div class="form-group">
            <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
            <input type="text" id="username" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" maxlength="20">
        </div>
        <div class="form-group">
            <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
            <input type="password" id="password" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
        </div>
        <button id="login-button" class="login-button">–í–æ–π—Ç–∏ –≤ –∏–≥—Ä—É</button>
        <div class="register-link">
            –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="register-link">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a> –≤ –±–æ—Ç–µ Telegram!
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–≥—Ä—ã -->
    <div id="game-screen" class="container" style="display: none;">
        <div class="header">
            <h1 class="game-title">RPG Fantasy</h1>
            <p>–≠–ø–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –∂–¥–µ—Ç!</p>
        </div>

        <!-- –û–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–∏ -->
        <div class="online-players">
            <div class="online-players-title">–û–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–∏: <span id="online-count">1</span></div>
            <div class="online-players-list" id="online-players-list">
                <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <div class="player-info">
            <div class="info-item">
                <div class="info-label">–ò–≥—Ä–æ–∫</div>
                <div id="player-name" class="info-value">–ì–µ—Ä–æ–π</div>
            </div>
            <div class="info-item">
                <div class="info-label">–£—Ä–æ–≤–µ–Ω—å</div>
                <div id="player-level" class="info-value">1</div>
            </div>
            <div class="info-item">
                <div class="info-label">–ó–¥–æ—Ä–æ–≤—å–µ</div>
                <div id="player-health" class="info-value">100/100</div>
                <div class="progress-bar">
                    <div id="health-bar" class="progress-fill" style="width: 100%"></div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-label">–≠–Ω–µ—Ä–≥–∏—è</div>
                <div id="player-energy" class="info-value">100/100</div>
                <div class="progress-bar">
                    <div id="energy-bar" class="progress-fill" style="width: 100%"></div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-label">–û–ø—ã—Ç</div>
                <div id="player-exp" class="info-value">0/100</div>
                <div class="progress-bar">
                    <div id="exp-bar" class="progress-fill" style="width: 0%"></div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-label">–ó–æ–ª–æ—Ç–æ</div>
                <div id="player-gold" class="info-value">50</div>
            </div>
        </div>

        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="actions">–î–µ–π—Å—Ç–≤–∏—è</div>
            <div class="nav-tab" data-tab="inventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
            <div class="nav-tab" data-tab="crafting">–ö—Ä–∞—Ñ—Ç</div>
            <div class="nav-tab" data-tab="skills">–ù–∞–≤—ã–∫–∏</div>
            <div class="nav-tab" data-tab="pvp">PvP –ê—Ä–µ–Ω–∞</div>
            <div class="nav-tab" data-tab="market">–†—ã–Ω–æ–∫</div>
            <div class="nav-tab" data-tab="guild">–ì–∏–ª—å–¥–∏—è</div>
            <div class="nav-tab" data-tab="chat">–ß–∞—Ç</div>
            <div class="nav-tab admin-tab" data-tab="admin" style="display: none;">–ê–¥–º–∏–Ω</div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –î–µ–π—Å—Ç–≤–∏—è -->
        <div id="actions-tab" class="tab-content active">
            <h2 class="section-title">–î–µ–π—Å—Ç–≤–∏—è</h2>
            <div class="action-grid">
                <div class="action-card" data-action="hunt">
                    <div class="energy-cost">10</div>
                    <div class="action-icon">‚öîÔ∏è</div>
                    <div class="action-name">–û—Ö–æ—Ç–∞</div>
                    <div class="action-desc">–û—Ö–æ—Ç–∏—Ç—å—Å—è –Ω–∞ –º–æ–Ω—Å—Ç—Ä–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–ø—ã—Ç–∞ –∏ –∑–æ–ª–æ—Ç–∞</div>
                    <div class="cooldown" id="hunt-cooldown"></div>
                </div>
                <div class="action-card" data-action="mine">
                    <div class="energy-cost">8</div>
                    <div class="action-icon">‚õèÔ∏è</div>
                    <div class="action-name">–î–æ–±—ã—á–∞ —Ä—É–¥—ã</div>
                    <div class="action-desc">–î–æ–±—ã–≤–∞—Ç—å —Ä—É–¥—É –¥–ª—è –∫—Ä–∞—Ñ—Ç–∞</div>
                    <div class="cooldown" id="mine-cooldown"></div>
                </div>
                <div class="action-card" data-action="fish">
                    <div class="energy-cost">7</div>
                    <div class="action-icon">üé£</div>
                    <div class="action-name">–†—ã–±–∞–ª–∫–∞</div>
                    <div class="action-desc">–õ–æ–≤–∏—Ç—å —Ä—ã–±—É –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –µ–¥—ã</div>
                    <div class="cooldown" id="fish-cooldown"></div>
                </div>
                <div class="action-card" data-action="train">
                    <div class="energy-cost">15</div>
                    <div class="action-icon">üí™</div>
                    <div class="action-name">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</div>
                    <div class="action-desc">–£–≤–µ–ª–∏—á–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</div>
                    <div class="cooldown" id="train-cooldown"></div>
                </div>
                <div class="action-card" data-action="quest">
                    <div class="energy-cost">20</div>
                    <div class="action-icon">üìú</div>
                    <div class="action-name">–ó–∞–¥–∞–Ω–∏–µ</div>
                    <div class="action-desc">–í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –Ω–∞–≥—Ä–∞–¥—ã</div>
                    <div class="cooldown" id="quest-cooldown"></div>
                </div>
                <div class="action-card" data-action="bonus">
                    <div class="energy-cost">0</div>
                    <div class="action-icon">üéÅ</div>
                    <div class="action-name">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å</div>
                    <div class="action-desc">–ü–æ–ª—É—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É</div>
                    <div class="cooldown" id="bonus-cooldown"></div>
                </div>
                <div class="action-card" data-action="dungeon">
                    <div class="energy-cost">25</div>
                    <div class="action-icon">üè∞</div>
                    <div class="action-name">–ü–æ–¥–∑–µ–º–µ–ª—å–µ</div>
                    <div class="action-desc">–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø–æ–¥–∑–µ–º–µ–ª—å–µ –¥–ª—è —Ä–µ–¥–∫–∏—Ö –Ω–∞–≥—Ä–∞–¥</div>
                    <div class="cooldown" id="dungeon-cooldown"></div>
                </div>
                <div class="action-card" data-action="rest">
                    <div class="energy-cost">-30</div>
                    <div class="action-icon">üõå</div>
                    <div class="action-name">–û—Ç–¥—ã—Ö</div>
                    <div class="action-desc">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –∏ —ç–Ω–µ—Ä–≥–∏—é</div>
                    <div class="cooldown" id="rest-cooldown"></div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
        <div id="inventory-tab" class="tab-content">
            <h2 class="section-title">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="total-items">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="inventory-value">0</div>
                    <div class="stat-label">–°—Ç–æ–∏–º–æ—Å—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è</div>
                </div>
            </div>
            <div class="inventory-grid">
                <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ö—Ä–∞—Ñ—Ç -->
        <div id="crafting-tab" class="tab-content">
            <h2 class="section-title">–ö—Ä–∞—Ñ—Ç</h2>
            <div class="crafting-item">
                <div class="craft-info">
                    <div class="craft-name">–ü—Ä–æ—Å—Ç–æ–µ –∑–µ–ª—å–µ</div>
                    <div class="craft-requirements">–¢—Ä–µ–±—É–µ—Ç—Å—è: 2 –º—è—Å–∞, 1 —Ä—ã–±–∞</div>
                </div>
                <button class="craft-button" data-craft="potion">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <div class="crafting-item">
                <div class="craft-info">
                    <div class="craft-name">–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –º–µ—á</div>
                    <div class="craft-requirements">–¢—Ä–µ–±—É–µ—Ç—Å—è: 5 —Ä—É–¥—ã, 2 –º—è—Å–∞</div>
                </div>
                <button class="craft-button" data-craft="sword">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <div class="crafting-item">
                <div class="craft-info">
                    <div class="craft-name">–ö–æ–∂–∞–Ω–∞—è –±—Ä–æ–Ω—è</div>
                    <div class="craft-requirements">–¢—Ä–µ–±—É–µ—Ç—Å—è: 10 –º—è—Å–∞, 5 —Ä—ã–±—ã</div>
                </div>
                <button class="craft-button" data-craft="armor">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <div class="crafting-item">
                <div class="craft-info">
                    <div class="craft-name">–£–ª—É—á—à–µ–Ω–Ω–æ–µ –∑–µ–ª—å–µ</div>
                    <div class="craft-requirements">–¢—Ä–µ–±—É–µ—Ç—Å—è: 1 –ø—Ä–æ—Å—Ç–æ–µ –∑–µ–ª—å–µ, 5 —Ä—É–¥—ã</div>
                </div>
                <button class="craft-button" data-craft="super-potion">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <div class="crafting-item">
                <div class="craft-info">
                    <div class="craft-name">–°—Ç–∞–ª—å–Ω–æ–π –º–µ—á</div>
                    <div class="craft-requirements">–¢—Ä–µ–±—É–µ—Ç—Å—è: 15 —Ä—É–¥—ã, 3 –¥–µ—Ä–µ–≤—è–Ω–Ω—ã—Ö –º–µ—á–∞</div>
                </div>
                <button class="craft-button" data-craft="steel-sword">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <div class="crafting-item">
                <div class="craft-info">
                    <div class="craft-name">–ú–∞–≥–∏—á–µ—Å–∫–∏–π –∞–º—É–ª–µ—Ç</div>
                    <div class="craft-requirements">–¢—Ä–µ–±—É–µ—Ç—Å—è: 5 —É–ª—É—á—à–µ–Ω–Ω—ã—Ö –∑–µ–ª–∏–π, 10 —Ä—É–¥—ã</div>
                </div>
                <button class="craft-button" data-craft="amulet">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ù–∞–≤—ã–∫–∏ -->
        <div id="skills-tab" class="tab-content">
            <h2 class="section-title">–ù–∞–≤—ã–∫–∏</h2>
            <div class="skills-grid">
                <div class="skill-item">
                    <div class="skill-header">
                        <div class="skill-name">–°–∏–ª–∞</div>
                        <div class="skill-level">–£—Ä. <span id="strength-level">1</span></div>
                    </div>
                    <div class="skill-bar">
                        <div id="strength-bar" class="skill-fill" style="width: 0%"></div>
                    </div>
                    <button class="upgrade-button" data-skill="strength">–£–ª—É—á—à–∏—Ç—å (50 –∑–æ–ª–æ—Ç–∞)</button>
                </div>
                <div class="skill-item">
                    <div class="skill-header">
                        <div class="skill-name">–õ–æ–≤–∫–æ—Å—Ç—å</div>
                        <div class="skill-level">–£—Ä. <span id="agility-level">1</span></div>
                    </div>
                    <div class="skill-bar">
                        <div id="agility-bar" class="skill-fill" style="width: 0%"></div>
                    </div>
                    <button class="upgrade-button" data-skill="agility">–£–ª—É—á—à–∏—Ç—å (50 –∑–æ–ª–æ—Ç–∞)</button>
                </div>
                <div class="skill-item">
                    <div class="skill-header">
                        <div class="skill-name">–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç</div>
                        <div class="skill-level">–£—Ä. <span id="intelligence-level">1</span></div>
                    </div>
                    <div class="skill-bar">
                        <div id="intelligence-bar" class="skill-fill" style="width: 0%"></div>
                    </div>
                    <button class="upgrade-button" data-skill="intelligence">–£–ª—É—á—à–∏—Ç—å (50 –∑–æ–ª–æ—Ç–∞)</button>
                </div>
                <div class="skill-item">
                    <div class="skill-header">
                        <div class="skill-name">–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å</div>
                        <div class="skill-level">–£—Ä. <span id="stamina-level">1</span></div>
                    </div>
                    <div class="skill-bar">
                        <div id="stamina-bar" class="skill-fill" style="width: 0%"></div>
                    </div>
                    <button class="upgrade-button" data-skill="stamina">–£–ª—É—á—à–∏—Ç—å (50 –∑–æ–ª–æ—Ç–∞)</button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ PvP –ê—Ä–µ–Ω–∞ -->
        <div id="pvp-tab" class="tab-content">
            <h2 class="section-title">PvP –ê—Ä–µ–Ω–∞</h2>
            <div id="pvp-players-list">
                <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è PvP –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="pvp-player">
                <div class="player-details">
                    <div class="player-name">–°–ª—É—á–∞–π–Ω—ã–π —Å–æ–ø–µ—Ä–Ω–∏–∫</div>
                    <div class="player-level">–£—Ä–æ–≤–µ–Ω—å: 5-15</div>
                </div>
                <button class="attack-button" data-opponent="random">–ê—Ç–∞–∫–æ–≤–∞—Ç—å</button>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –†—ã–Ω–æ–∫ -->
        <div id="market-tab" class="tab-content">
            <h2 class="section-title">–†—ã–Ω–æ–∫</h2>
            <div class="market-item">
                <div class="market-info">
                    <div class="market-name">–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è</div>
                    <div class="market-price">–¶–µ–Ω–∞: 20 –∑–æ–ª–æ—Ç–∞</div>
                </div>
                <button class="buy-button" data-item="health-potion">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="market-item">
                <div class="market-info">
                    <div class="market-name">–ó–µ–ª—å–µ —ç–Ω–µ—Ä–≥–∏–∏</div>
                    <div class="market-price">–¶–µ–Ω–∞: 15 –∑–æ–ª–æ—Ç–∞</div>
                </div>
                <button class="buy-button" data-item="energy-potion">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="market-item">
                <div class="market-info">
                    <div class="market-name">–£–ª—É—á—à–µ–Ω–Ω—ã–π –º–µ—á</div>
                    <div class="market-price">–¶–µ–Ω–∞: 100 –∑–æ–ª–æ—Ç–∞</div>
                </div>
                <button class="buy-button" data-item="upgraded-sword">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="market-item">
                <div class="market-info">
                    <div class="market-name">–ó–∞—â–∏—Ç–Ω—ã–π –∞–º—É–ª–µ—Ç</div>
                    <div class="market-price">–¶–µ–Ω–∞: 80 –∑–æ–ª–æ—Ç–∞</div>
                </div>
                <button class="buy-button" data-item="defense-amulet">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="market-item">
                <div class="market-info">
                    <div class="market-name">–°—É–Ω–¥—É–∫ —Å —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏</div>
                    <div class="market-price">–¶–µ–Ω–∞: 200 –∑–æ–ª–æ—Ç–∞</div>
                </div>
                <button class="buy-button" data-item="treasure-chest">–ö—É–ø–∏—Ç—å</button>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ì–∏–ª—å–¥–∏—è -->
        <div id="guild-tab" class="tab-content">
            <h2 class="section-title">–ì–∏–ª—å–¥–∏—è</h2>
            <div class="guild-section">
                <div class="guild-info">
                    <div>
                        <div class="info-label">–ù–∞–∑–≤–∞–Ω–∏–µ –≥–∏–ª—å–¥–∏–∏</div>
                        <div class="info-value">–†—ã—Ü–∞—Ä–∏ –°–≤–µ—Ç–∞</div>
                    </div>
                    <div>
                        <div class="info-label">–£—Ä–æ–≤–µ–Ω—å –≥–∏–ª—å–¥–∏–∏</div>
                        <div class="info-value">5</div>
                    </div>
                </div>
                <div class="guild-info">
                    <div>
                        <div class="info-label">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                        <div class="info-value">12/20</div>
                    </div>
                    <div>
                        <div class="info-label">–†–µ–π—Ç–∏–Ω–≥</div>
                        <div class="info-value">#15</div>
                    </div>
                </div>
                <button class="join-guild-button">–í—Å—Ç—É–ø–∏—Ç—å –≤ –≥–∏–ª—å–¥–∏—é</button>
            </div>
            <div class="guild-members">
                <h3 style="margin-bottom: 10px;">–£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥–∏–ª—å–¥–∏–∏</h3>
                <div class="guild-member">
                    <div>–ì—Ä–æ–Ω–¥–æ—Ä (–õ–∏–¥–µ—Ä)</div>
                    <div>–£—Ä. 25</div>
                </div>
                <div class="guild-member">
                    <div>–≠–ª–≤–∏–Ω</div>
                    <div>–£—Ä. 22</div>
                </div>
                <div class="guild-member">
                    <div>–¢–æ—Ä–∏–Ω</div>
                    <div>–£—Ä. 20</div>
                </div>
                <div class="guild-member">
                    <div>–ê—Ä–∞–≥–æ—Ä–Ω</div>
                    <div>–£—Ä. 18</div>
                </div>
                <div class="guild-member">
                    <div>–õ–µ–≥–æ–ª–∞—Å</div>
                    <div>–£—Ä. 17</div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ß–∞—Ç -->
        <div id="chat-tab" class="tab-content">
            <h2 class="section-title">–û–±—â–∏–π —á–∞—Ç</h2>
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages">
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                <div class="chat-input-container">
                    <input type="text" id="chat-input" class="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="200">
                    <button id="chat-send" class="chat-send">–û—Ç–ø—Ä.</button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
        <div id="admin-tab" class="tab-content admin-panel">
            <h2 class="section-title">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
            <div class="admin-section">
                <h3 style="margin-bottom: 10px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–º</h3>
                <input type="text" id="admin-gold" class="admin-input" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–æ–ª–æ—Ç–∞">
                <button class="admin-button" id="add-gold">–î–æ–±–∞–≤–∏—Ç—å –∑–æ–ª–æ—Ç–æ</button>
                <input type="text" id="admin-exp" class="admin-input" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø—ã—Ç–∞">
                <button class="admin-button" id="add-exp">–î–æ–±–∞–≤–∏—Ç—å –æ–ø—ã—Ç</button>
                <input type="text" id="admin-level" class="admin-input" placeholder="–£—Ä–æ–≤–µ–Ω—å">
                <button class="admin-button" id="set-level">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</button>
            </div>
            <div class="admin-section">
                <h3 style="margin-bottom: 10px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏</h3>
                <select id="admin-item" class="admin-input">
                    <option value="meat">–ú—è—Å–æ</option>
                    <option value="fish">–†—ã–±–∞</option>
                    <option value="ore">–†—É–¥–∞</option>
                    <option value="potion">–ü—Ä–æ—Å—Ç–æ–µ –∑–µ–ª—å–µ</option>
                    <option value="sword">–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –º–µ—á</option>
                </select>
                <input type="text" id="admin-item-count" class="admin-input" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                <button class="admin-button" id="add-item">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç</button>
            </div>
            <div class="admin-section">
                <h3 style="margin-bottom: 10px;">–°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã</h3>
                <button class="admin-button" id="reset-player">–°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä–æ–∫–∞</button>
                <button class="admin-button" id="save-game">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä—É</button>
                <button class="admin-button" id="load-game">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–≥—Ä—É</button>
            </div>
        </div>

        <div class="footer">
            RPG Fantasy Bot | –°–∞–π—Ç: <a href="https://lesatrufa-byte.github.io/VeyGamee/" style="color: var(--warning-color);">https://lesatrufa-byte.github.io/VeyGamee/</a>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram?.WebApp;
        if (tg) {
            tg.expand();
            tg.enableClosingConfirmation();
        }

        // –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
        const MultiplayerAPI = {
            // –≠–º—É–ª—è—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ localStorage (–¥–ª—è –¥–µ–º–æ)
            players: JSON.parse(localStorage.getItem('rpgFantasyPlayers') || '{}'),
            chatMessages: JSON.parse(localStorage.getItem('rpgFantasyChat') || '[]'),
            
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–∞
            savePlayer(playerId, playerData) {
                this.players[playerId] = {
                    ...playerData,
                    lastSeen: Date.now(),
                    online: true
                };
                this.savePlayers();
            },
            
            // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
            getOnlinePlayers() {
                const now = Date.now();
                const onlinePlayers = {};
                
                for (const [id, player] of Object.entries(this.players)) {
                    // –ò–≥—Ä–æ–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ–Ω–ª–∞–π–Ω, –µ—Å–ª–∏ –±—ã–ª –∞–∫—Ç–∏–≤–µ–Ω –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∏–Ω—É—Ç
                    if (now - player.lastSeen < 5 * 60 * 1000) {
                        onlinePlayers[id] = player;
                    }
                }
                
                return onlinePlayers;
            },
            
            // –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
            addChatMessage(playerName, message) {
                this.chatMessages.push({
                    playerName,
                    message,
                    timestamp: Date.now()
                });
                
                // –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞
                if (this.chatMessages.length > 50) {
                    this.chatMessages = this.chatMessages.slice(-50);
                }
                
                localStorage.setItem('rpgFantasyChat', JSON.stringify(this.chatMessages));
            },
            
            // –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞
            getChatMessages() {
                return this.chatMessages.slice(-20); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π
            },
            
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–æ–≤
            savePlayers() {
                localStorage.setItem('rpgFantasyPlayers', JSON.stringify(this.players));
            }
        };

        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞
        let player = {
            id: null,
            username: '',
            level: 1,
            exp: 0,
            expToNextLevel: 100,
            health: 100,
            maxHealth: 100,
            energy: 100,
            maxEnergy: 100,
            gold: 50,
            isAdmin: false,
            skills: {
                strength: { level: 1, exp: 0, expToNextLevel: 100 },
                agility: { level: 1, exp: 0, expToNextLevel: 100 },
                intelligence: { level: 1, exp: 0, expToNextLevel: 100 },
                stamina: { level: 1, exp: 0, expToNextLevel: 100 }
            },
            inventory: {
                meat: { name: '–ú—è—Å–æ', count: 0, rarity: 'common' },
                fish: { name: '–†—ã–±–∞', count: 0, rarity: 'common' },
                ore: { name: '–†—É–¥–∞', count: 0, rarity: 'common' },
                potion: { name: '–ü—Ä–æ—Å—Ç–æ–µ –∑–µ–ª—å–µ', count: 0, rarity: 'uncommon' },
                sword: { name: '–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –º–µ—á', count: 0, rarity: 'uncommon' },
                armor: { name: '–ö–æ–∂–∞–Ω–∞—è –±—Ä–æ–Ω—è', count: 0, rarity: 'rare' },
                'super-potion': { name: '–£–ª—É—á—à–µ–Ω–Ω–æ–µ –∑–µ–ª—å–µ', count: 0, rarity: 'rare' },
                'steel-sword': { name: '–°—Ç–∞–ª—å–Ω–æ–π –º–µ—á', count: 0, rarity: 'epic' },
                amulet: { name: '–ú–∞–≥–∏—á–µ—Å–∫–∏–π –∞–º—É–ª–µ—Ç', count: 0, rarity: 'legendary' }
            },
            cooldowns: {
                hunt: 0,
                mine: 0,
                fish: 0,
                train: 0,
                quest: 0,
                bonus: 0,
                dungeon: 0,
                rest: 0
            },
            lastBonus: 0
        };

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const loginScreen = document.getElementById('login-screen');
        const gameScreen = document.getElementById('game-screen');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginButton = document.getElementById('login-button');
        const registerLink = document.getElementById('register-link');
        const playerName = document.getElementById('player-name');
        const playerLevel = document.getElementById('player-level');
        const playerHealth = document.getElementById('player-health');
        const playerEnergy = document.getElementById('player-energy');
        const playerExp = document.getElementById('player-exp');
        const playerGold = document.getElementById('player-gold');
        const healthBar = document.getElementById('health-bar');
        const energyBar = document.getElementById('energy-bar');
        const expBar = document.getElementById('exp-bar');
        const notification = document.getElementById('notification');
        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        const modalButtonOk = document.getElementById('modal-button-ok');
        const modalButtonCancel = document.getElementById('modal-button-cancel');
        const adminTab = document.querySelector('.admin-tab');
        const onlineCount = document.getElementById('online-count');
        const onlinePlayersList = document.getElementById('online-players-list');
        const pvpPlayersList = document.getElementById('pvp-players-list');
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const chatSend = document.getElementById('chat-send');

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.style.display = 'block';
            notification.style.background = type === 'success' ? 'var(--success-color)' : 
                                           type === 'error' ? 'var(--danger-color)' : 
                                           type === 'warning' ? 'var(--warning-color)' : 'var(--info-color)';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function showModal(title, text, onConfirm = null, onCancel = null) {
            modalTitle.textContent = title;
            modalText.textContent = text;
            modal.style.display = 'flex';
            
            modalButtonOk.onclick = function() {
                modal.style.display = 'none';
                if (onConfirm) onConfirm();
            };
            
            modalButtonCancel.onclick = function() {
                modal.style.display = 'none';
                if (onCancel) onCancel();
            };
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–≥—Ä–æ–∫–∞
        function updatePlayerUI() {
            playerName.textContent = player.username;
            playerLevel.textContent = player.level;
            playerHealth.textContent = `${player.health}/${player.maxHealth}`;
            playerEnergy.textContent = `${player.energy}/${player.maxEnergy}`;
            playerExp.textContent = `${player.exp}/${player.expToNextLevel}`;
            playerGold.textContent = player.gold;
            
            healthBar.style.width = `${(player.health / player.maxHealth) * 100}%`;
            energyBar.style.width = `${(player.energy / player.maxEnergy) * 100}%`;
            expBar.style.width = `${(player.exp / player.expToNextLevel) * 100}%`;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–≤—ã–∫–æ–≤
            document.getElementById('strength-level').textContent = player.skills.strength.level;
            document.getElementById('agility-level').textContent = player.skills.agility.level;
            document.getElementById('intelligence-level').textContent = player.skills.intelligence.level;
            document.getElementById('stamina-level').textContent = player.skills.stamina.level;
            
            document.getElementById('strength-bar').style.width = `${(player.skills.strength.exp / player.skills.strength.expToNextLevel) * 100}%`;
            document.getElementById('agility-bar').style.width = `${(player.skills.agility.exp / player.skills.agility.expToNextLevel) * 100}%`;
            document.getElementById('intelligence-bar').style.width = `${(player.skills.intelligence.exp / player.skills.intelligence.expToNextLevel) * 100}%`;
            document.getElementById('stamina-bar').style.width = `${(player.skills.stamina.exp / player.skills.stamina.expToNextLevel) * 100}%`;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            updateInventoryUI();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–¥
            updateCooldowns();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞
            updateOnlineStatus();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ PvP —Å–ø–∏—Å–∫–∞
            updatePvPPlayers();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
            updateChat();
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function updateInventoryUI() {
            const inventoryGrid = document.querySelector('.inventory-grid');
            inventoryGrid.innerHTML = '';
            
            let totalItems = 0;
            let inventoryValue = 0;
            
            for (const itemId in player.inventory) {
                const item = player.inventory[itemId];
                if (item.count > 0) {
                    totalItems += item.count;
                    inventoryValue += getItemValue(itemId) * item.count;
                    
                    const itemElement = document.createElement('div');
                    itemElement.className = 'inventory-item';
                    itemElement.innerHTML = `
                        <div class="item-icon">${getItemIcon(itemId)}</div>
                        <div class="item-name">${item.name}</div>
                        <div class="item-count">${item.count}</div>
                        <div class="item-rarity rarity-${item.rarity}">${getRarityText(item.rarity)}</div>
                    `;
                    inventoryGrid.appendChild(itemElement);
                }
            }
            
            document.getElementById('total-items').textContent = totalItems;
            document.getElementById('inventory-value').textContent = inventoryValue;
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–∞
        function getItemIcon(itemId) {
            const icons = {
                meat: 'üçñ',
                fish: 'üêü',
                ore: '‚õèÔ∏è',
                potion: 'üß™',
                sword: '‚öîÔ∏è',
                armor: 'üõ°Ô∏è',
                'super-potion': 'üîÆ',
                'steel-sword': 'üó°Ô∏è',
                amulet: 'üìø'
            };
            return icons[itemId] || 'üì¶';
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–¥–∫–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–æ–º
        function getRarityText(rarity) {
            const rarities = {
                common: '–û–±—ã—á–Ω.',
                uncommon: '–ù–µ–æ–±—ã—á–Ω.',
                rare: '–†–µ–¥–∫–∏–π',
                epic: '–≠–ø–∏—á–µ—Å–∫–∏–π',
                legendary: '–õ–µ–≥–µ–Ω–¥.'
            };
            return rarities[rarity] || '–û–±—ã—á–Ω.';
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç–∞
        function getItemValue(itemId) {
            const values = {
                meat: 5,
                fish: 3,
                ore: 8,
                potion: 20,
                sword: 50,
                armor: 80,
                'super-potion': 50,
                'steel-sword': 150,
                amulet: 300
            };
            return values[itemId] || 0;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–¥
        function updateCooldowns() {
            for (const action in player.cooldowns) {
                const cooldownElement = document.getElementById(`${action}-cooldown`);
                if (cooldownElement) {
                    if (player.cooldowns[action] > 0) {
                        cooldownElement.textContent = `–ö–î: ${player.cooldowns[action]}—Å`;
                    } else {
                        cooldownElement.textContent = '';
                    }
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–¥
        function checkCooldown(action) {
            return player.cooldowns[action] <= 0;
        }

        // –§—É–Ω–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–¥
        function setCooldown(action, seconds) {
            player.cooldowns[action] = seconds;
            
            const interval = setInterval(() => {
                player.cooldowns[action]--;
                updateCooldowns();
                
                if (player.cooldowns[action] <= 0) {
                    clearInterval(interval);
                }
            }, 1000);
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞
        function updateOnlineStatus() {
            if (!player.id) return;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –∏–≥—Ä–æ–∫–∞
            MultiplayerAPI.savePlayer(player.id, player);
            
            // –ü–æ–ª—É—á–∞–µ–º –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–æ–∫–æ–≤
            const onlinePlayers = MultiplayerAPI.getOnlinePlayers();
            const onlinePlayersCount = Object.keys(onlinePlayers).length;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
            onlineCount.textContent = onlinePlayersCount;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
            onlinePlayersList.innerHTML = '';
            
            for (const [id, onlinePlayer] of Object.entries(onlinePlayers)) {
                if (id !== player.id) {
                    const playerElement = document.createElement('div');
                    playerElement.className = 'online-player';
                    playerElement.textContent = `${onlinePlayer.username} (${onlinePlayer.level})`;
                    onlinePlayersList.appendChild(playerElement);
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è PvP —Å–ø–∏—Å–∫–∞
        function updatePvPPlayers() {
            if (!player.id) return;
            
            const onlinePlayers = MultiplayerAPI.getOnlinePlayers();
            pvpPlayersList.innerHTML = '';
            
            for (const [id, onlinePlayer] of Object.entries(onlinePlayers)) {
                if (id !== player.id && onlinePlayer.level >= player.level - 5 && onlinePlayer.level <= player.level + 5) {
                    const playerElement = document.createElement('div');
                    playerElement.className = 'pvp-player';
                    playerElement.innerHTML = `
                        <div class="player-details">
                            <div class="player-name">${onlinePlayer.username}</div>
                            <div class="player-level">–£—Ä–æ–≤–µ–Ω—å: ${onlinePlayer.level}</div>
                        </div>
                        <button class="attack-button" data-opponent="${id}">–ê—Ç–∞–∫–æ–≤–∞—Ç—å</button>
                    `;
                    pvpPlayersList.appendChild(playerElement);
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫
            pvpPlayersList.querySelectorAll('.attack-button').forEach(button => {
                button.addEventListener('click', function() {
                    const opponentId = this.getAttribute('data-opponent');
                    attackPlayer(opponentId);
                });
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–∞—Ç–∞
        function updateChat() {
            const messages = MultiplayerAPI.getChatMessages();
            chatMessages.innerHTML = '';
            
            messages.forEach(msg => {
                const messageElement = document.createElement('div');
                messageElement.className = 'chat-message';
                messageElement.innerHTML = `
                    <span class="chat-sender">${msg.playerName}:</span> ${msg.message}
                `;
                chatMessages.appendChild(messageElement);
            });
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
        function sendChatMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            
            MultiplayerAPI.addChatMessage(player.username, message);
            chatInput.value = '';
            updateChat();
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è
        function handleAction(action) {
            if (!checkCooldown(action)) {
                showNotification('–î–µ–π—Å—Ç–≤–∏–µ –µ—â–µ –Ω–∞ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–µ!', 'warning');
                return;
            }
            
            let energyCost = 0;
            let success = false;
            let message = '';
            
            switch (action) {
                case 'hunt':
                    energyCost = 10;
                    if (player.energy >= energyCost) {
                        player.energy -= energyCost;
                        const expGain = 10 + Math.floor(Math.random() * 10);
                        const goldGain = 5 + Math.floor(Math.random() * 10);
                        const itemDrop = Math.random() < 0.3 ? 'meat' : null;
                        
                        player.exp += expGain;
                        player.gold += goldGain;
                        
                        message = `–í—ã –æ—Ö–æ—Ç–∏–ª–∏—Å—å –∏ –ø–æ–ª—É—á–∏–ª–∏ ${expGain} –æ–ø—ã—Ç–∞ –∏ ${goldGain} –∑–æ–ª–æ—Ç–∞`;
                        
                        if (itemDrop) {
                            player.inventory[itemDrop].count++;
                            message += `, –∞ —Ç–∞–∫–∂–µ ${player.inventory[itemDrop].name}`;
                        }
                        
                        success = true;
                        setCooldown('hunt', 30);
                    }
                    break;
                    
                case 'mine':
                    energyCost = 8;
                    if (player.energy >= energyCost) {
                        player.energy -= energyCost;
                        const expGain = 5 + Math.floor(Math.random() * 5);
                        const oreGain = 1 + Math.floor(Math.random() * 3);
                        
                        player.exp += expGain;
                        player.inventory.ore.count += oreGain;
                        
                        message = `–í—ã –¥–æ–±—ã–ª–∏ —Ä—É–¥—É –∏ –ø–æ–ª—É—á–∏–ª–∏ ${expGain} –æ–ø—ã—Ç–∞ –∏ ${oreGain} —Ä—É–¥—ã`;
                        success = true;
                        setCooldown('mine', 20);
                    }
                    break;
                    
                case 'fish':
                    energyCost = 7;
                    if (player.energy >= energyCost) {
                        player.energy -= energyCost;
                        const expGain = 3 + Math.floor(Math.random() * 5);
                        const fishGain = 1 + Math.floor(Math.random() * 2);
                        
                        player.exp += expGain;
                        player.inventory.fish.count += fishGain;
                        
                        message = `–í—ã —Ä—ã–±–∞—á–∏–ª–∏ –∏ –ø–æ–ª—É—á–∏–ª–∏ ${expGain} –æ–ø—ã—Ç–∞ –∏ ${fishGain} —Ä—ã–±—ã`;
                        success = true;
                        setCooldown('fish', 15);
                    }
                    break;
                    
                case 'train':
                    energyCost = 15;
                    if (player.energy >= energyCost) {
                        player.energy -= energyCost;
                        const skill = Object.keys(player.skills)[Math.floor(Math.random() * Object.keys(player.skills).length)];
                        const expGain = 5 + Math.floor(Math.random() * 10);
                        
                        player.skills[skill].exp += expGain;
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –Ω–∞–≤—ã–∫–∞
                        if (player.skills[skill].exp >= player.skills[skill].expToNextLevel) {
                            player.skills[skill].level++;
                            player.skills[skill].exp = 0;
                            player.skills[skill].expToNextLevel = Math.floor(player.skills[skill].expToNextLevel * 1.5);
                            message = `–í—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏ –ø–æ–≤—ã—Å–∏–ª–∏ ${getSkillName(skill)} –¥–æ —É—Ä–æ–≤–Ω—è ${player.skills[skill].level}!`;
                        } else {
                            message = `–í—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏ –ø–æ–ª—É—á–∏–ª–∏ ${expGain} –æ–ø—ã—Ç–∞ –≤ ${getSkillName(skill)}`;
                        }
                        
                        success = true;
                        setCooldown('train', 60);
                    }
                    break;
                    
                case 'quest':
                    energyCost = 20;
                    if (player.energy >= energyCost) {
                        player.energy -= energyCost;
                        const expGain = 20 + Math.floor(Math.random() * 30);
                        const goldGain = 15 + Math.floor(Math.random() * 25);
                        
                        player.exp += expGain;
                        player.gold += goldGain;
                        
                        message = `–í—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –∑–∞–¥–∞–Ω–∏–µ –∏ –ø–æ–ª—É—á–∏–ª–∏ ${expGain} –æ–ø—ã—Ç–∞ –∏ ${goldGain} –∑–æ–ª–æ—Ç–∞`;
                        success = true;
                        setCooldown('quest', 120);
                    }
                    break;
                    
                case 'bonus':
                    energyCost = 0;
                    const now = Date.now();
                    const lastBonusTime = player.lastBonus || 0;
                    const oneDay = 24 * 60 * 60 * 1000;
                    
                    if (now - lastBonusTime >= oneDay) {
                        player.lastBonus = now;
                        const goldGain = 50 + Math.floor(Math.random() * 50);
                        player.gold += goldGain;
                        
                        message = `–í—ã –ø–æ–ª—É—á–∏–ª–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å: ${goldGain} –∑–æ–ª–æ—Ç–∞`;
                        success = true;
                        setCooldown('bonus', 24 * 60 * 60); // 24 —á–∞—Å–∞
                    } else {
                        const nextBonus = Math.ceil((oneDay - (now - lastBonusTime)) / (60 * 60 * 1000));
                        message = `–°–ª–µ–¥—É—é—â–∏–π –±–æ–Ω—É—Å —á–µ—Ä–µ–∑ ${nextBonus} —á–∞—Å–æ–≤`;
                        showNotification(message, 'warning');
                        return;
                    }
                    break;
                    
                case 'dungeon':
                    energyCost = 25;
                    if (player.energy >= energyCost) {
                        player.energy -= energyCost;
                        const expGain = 50 + Math.floor(Math.random() * 50);
                        const goldGain = 30 + Math.floor(Math.random() * 40);
                        const itemDrop = Math.random() < 0.5 ? getRandomRareItem() : null;
                        
                        player.exp += expGain;
                        player.gold += goldGain;
                        
                        message = `–í—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª–∏ –ø–æ–¥–∑–µ–º–µ–ª—å–µ –∏ –ø–æ–ª—É—á–∏–ª–∏ ${expGain} –æ–ø—ã—Ç–∞ –∏ ${goldGain} –∑–æ–ª–æ—Ç–∞`;
                        
                        if (itemDrop) {
                            player.inventory[itemDrop].count++;
                            message += `, –∞ —Ç–∞–∫–∂–µ ${player.inventory[itemDrop].name}`;
                        }
                        
                        success = true;
                        setCooldown('dungeon', 300);
                    }
                    break;
                    
                case 'rest':
                    energyCost = -30; // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
                    if (player.energy < player.maxEnergy || player.health < player.maxHealth) {
                        player.energy = Math.min(player.maxEnergy, player.energy + 30);
                        player.health = Math.min(player.maxHealth, player.health + 20);
                        
                        message = `–í—ã –æ—Ç–¥–æ—Ö–Ω—É–ª–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –∑–¥–æ—Ä–æ–≤—å–µ –∏ —ç–Ω–µ—Ä–≥–∏—é`;
                        success = true;
                        setCooldown('rest', 60);
                    } else {
                        message = `–£ –≤–∞—Å —É–∂–µ –ø–æ–ª–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –∏ —ç–Ω–µ—Ä–≥–∏—è`;
                        showNotification(message, 'warning');
                        return;
                    }
                    break;
            }
            
            if (success) {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
                checkLevelUp();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                updatePlayerUI();
                
                // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                showNotification(message);
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã
                saveGame();
            } else if (energyCost > 0 && player.energy < energyCost) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!', 'warning');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞–≤—ã–∫–∞
        function getSkillName(skillId) {
            const names = {
                strength: '–°–∏–ª—É',
                agility: '–õ–æ–≤–∫–æ—Å—Ç—å',
                intelligence: '–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç',
                stamina: '–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å'
            };
            return names[skillId] || '–ù–∞–≤—ã–∫';
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–µ–¥–∫–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞
        function getRandomRareItem() {
            const rareItems = ['potion', 'sword', 'armor', 'super-potion', 'steel-sword', 'amulet'];
            return rareItems[Math.floor(Math.random() * rareItems.length)];
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
        function checkLevelUp() {
            if (player.exp >= player.expToNextLevel) {
                player.level++;
                player.exp -= player.expToNextLevel;
                player.expToNextLevel = Math.floor(player.expToNextLevel * 1.5);
                player.maxHealth += 10;
                player.health = player.maxHealth;
                player.maxEnergy += 5;
                player.energy = player.maxEnergy;
                
                showModal('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!', `–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ ${player.level} —É—Ä–æ–≤–Ω—è! –í–∞—à–µ –∑–¥–æ—Ä–æ–≤—å–µ –∏ —ç–Ω–µ—Ä–≥–∏—è —É–≤–µ–ª–∏—á–µ–Ω—ã.`);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫—Ä–∞—Ñ—Ç–∞
        function handleCraft(item) {
            let requirementsMet = true;
            let message = '';
            
            switch (item) {
                case 'potion':
                    if (player.inventory.meat.count >= 2 && player.inventory.fish.count >= 1) {
                        player.inventory.meat.count -= 2;
                        player.inventory.fish.count -= 1;
                        player.inventory.potion.count++;
                        message = '–í—ã —Å–æ–∑–¥–∞–ª–∏ –ø—Ä–æ—Å—Ç–æ–µ –∑–µ–ª—å–µ!';
                    } else {
                        requirementsMet = false;
                        message = '–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: 2 –º—è—Å–∞, 1 —Ä—ã–±–∞';
                    }
                    break;
                    
                case 'sword':
                    if (player.inventory.ore.count >= 5 && player.inventory.meat.count >= 2) {
                        player.inventory.ore.count -= 5;
                        player.inventory.meat.count -= 2;
                        player.inventory.sword.count++;
                        message = '–í—ã —Å–æ–∑–¥–∞–ª–∏ –¥–µ—Ä–µ–≤—è–Ω–Ω—ã–π –º–µ—á!';
                    } else {
                        requirementsMet = false;
                        message = '–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: 5 —Ä—É–¥—ã, 2 –º—è—Å–∞';
                    }
                    break;
                    
                case 'armor':
                    if (player.inventory.meat.count >= 10 && player.inventory.fish.count >= 5) {
                        player.inventory.meat.count -= 10;
                        player.inventory.fish.count -= 5;
                        player.inventory.armor.count++;
                        message = '–í—ã —Å–æ–∑–¥–∞–ª–∏ –∫–æ–∂–∞–Ω—É—é –±—Ä–æ–Ω—é!';
                    } else {
                        requirementsMet = false;
                        message = '–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: 10 –º—è—Å–∞, 5 —Ä—ã–±—ã';
                    }
                    break;
                    
                case 'super-potion':
                    if (player.inventory.potion.count >= 1 && player.inventory.ore.count >= 5) {
                        player.inventory.potion.count -= 1;
                        player.inventory.ore.count -= 5;
                        player.inventory['super-potion'].count++;
                        message = '–í—ã —Å–æ–∑–¥–∞–ª–∏ —É–ª—É—á—à–µ–Ω–Ω–æ–µ –∑–µ–ª—å–µ!';
                    } else {
                        requirementsMet = false;
                        message = '–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: 1 –ø—Ä–æ—Å—Ç–æ–µ –∑–µ–ª—å–µ, 5 —Ä—É–¥—ã';
                    }
                    break;
                    
                case 'steel-sword':
                    if (player.inventory.ore.count >= 15 && player.inventory.sword.count >= 3) {
                        player.inventory.ore.count -= 15;
                        player.inventory.sword.count -= 3;
                        player.inventory['steel-sword'].count++;
                        message = '–í—ã —Å–æ–∑–¥–∞–ª–∏ —Å—Ç–∞–ª—å–Ω–æ–π –º–µ—á!';
                    } else {
                        requirementsMet = false;
                        message = '–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: 15 —Ä—É–¥—ã, 3 –¥–µ—Ä–µ–≤—è–Ω–Ω—ã—Ö –º–µ—á–∞';
                    }
                    break;
                    
                case 'amulet':
                    if (player.inventory['super-potion'].count >= 5 && player.inventory.ore.count >= 10) {
                        player.inventory['super-potion'].count -= 5;
                        player.inventory.ore.count -= 10;
                        player.inventory.amulet.count++;
                        message = '–í—ã —Å–æ–∑–¥–∞–ª–∏ –º–∞–≥–∏—á–µ—Å–∫–∏–π –∞–º—É–ª–µ—Ç!';
                    } else {
                        requirementsMet = false;
                        message = '–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: 5 —É–ª—É—á—à–µ–Ω–Ω—ã—Ö –∑–µ–ª–∏–π, 10 —Ä—É–¥—ã';
                    }
                    break;
            }
            
            if (requirementsMet) {
                showNotification(message);
                updatePlayerUI();
                saveGame();
            } else {
                showNotification(message, 'warning');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏—è –Ω–∞–≤—ã–∫–∞
        function upgradeSkill(skill) {
            const cost = 50;
            
            if (player.gold >= cost) {
                player.gold -= cost;
                player.skills[skill].exp += 25;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –Ω–∞–≤—ã–∫–∞
                if (player.skills[skill].exp >= player.skills[skill].expToNextLevel) {
                    player.skills[skill].level++;
                    player.skills[skill].exp = 0;
                    player.skills[skill].expToNextLevel = Math.floor(player.skills[skill].expToNextLevel * 1.5);
                    showNotification(`–í—ã —É–ª—É—á—à–∏–ª–∏ ${getSkillName(skill)} –¥–æ —É—Ä–æ–≤–Ω—è ${player.skills[skill].level}!`);
                } else {
                    showNotification(`–í—ã –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏ ${cost} –∑–æ–ª–æ—Ç–∞ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É ${getSkillName(skill)}`);
                }
                
                updatePlayerUI();
                saveGame();
            } else {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –Ω–∞–≤—ã–∫–∞!', 'warning');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ –Ω–∞ —Ä—ã–Ω–∫–µ
        function buyItem(item) {
            let cost = 0;
            let message = '';
            
            switch (item) {
                case 'health-potion':
                    cost = 20;
                    if (player.gold >= cost) {
                        player.gold -= cost;
                        player.health = Math.min(player.maxHealth, player.health + 30);
                        message = '–í—ã –∫—É–ø–∏–ª–∏ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ 30 HP';
                    }
                    break;
                    
                case 'energy-potion':
                    cost = 15;
                    if (player.gold >= cost) {
                        player.gold -= cost;
                        player.energy = Math.min(player.maxEnergy, player.energy + 25);
                        message = '–í—ã –∫—É–ø–∏–ª–∏ –∑–µ–ª—å–µ —ç–Ω–µ—Ä–≥–∏–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ 25 —ç–Ω–µ—Ä–≥–∏–∏';
                    }
                    break;
                    
                case 'upgraded-sword':
                    cost = 100;
                    if (player.gold >= cost) {
                        player.gold -= cost;
                        player.inventory['steel-sword'].count++;
                        message = '–í—ã –∫—É–ø–∏–ª–∏ —É–ª—É—á—à–µ–Ω–Ω—ã–π –º–µ—á!';
                    }
                    break;
                    
                case 'defense-amulet':
                    cost = 80;
                    if (player.gold >= cost) {
                        player.gold -= cost;
                        player.inventory.amulet.count++;
                        message = '–í—ã –∫—É–ø–∏–ª–∏ –∑–∞—â–∏—Ç–Ω—ã–π –∞–º—É–ª–µ—Ç!';
                    }
                    break;
                    
                case 'treasure-chest':
                    cost = 200;
                    if (player.gold >= cost) {
                        player.gold -= cost;
                        const reward = 100 + Math.floor(Math.random() * 100);
                        player.gold += reward;
                        message = `–í—ã –∫—É–ø–∏–ª–∏ —Å—É–Ω–¥—É–∫ —Å —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏ –∏ –Ω–∞—à–ª–∏ ${reward} –∑–æ–ª–æ—Ç–∞!`;
                    }
                    break;
            }
            
            if (cost > 0) {
                if (player.gold >= cost) {
                    showNotification(message);
                    updatePlayerUI();
                    saveGame();
                } else {
                    showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏!', 'warning');
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∞—Ç–∞–∫–∏ –∏–≥—Ä–æ–∫–∞
        function attackPlayer(opponentId) {
            const onlinePlayers = MultiplayerAPI.getOnlinePlayers();
            const opponent = onlinePlayers[opponentId];
            
            if (!opponent) {
                showNotification('–ò–≥—Ä–æ–∫ –±–æ–ª—å—à–µ –Ω–µ –≤ —Å–µ—Ç–∏!', 'warning');
                updatePvPPlayers();
                return;
            }
            
            const winChance = Math.max(0.1, 0.5 - (opponent.level - player.level) * 0.1);
            
            if (Math.random() < winChance) {
                const expGain = opponent.level * 5;
                const goldGain = opponent.level * 3;
                
                player.exp += expGain;
                player.gold += goldGain;
                
                showModal('–ü–æ–±–µ–¥–∞!', `–í—ã –ø–æ–±–µ–¥–∏–ª–∏ ${opponent.username} –∏ –ø–æ–ª—É—á–∏–ª–∏ ${expGain} –æ–ø—ã—Ç–∞ –∏ ${goldGain} –∑–æ–ª–æ—Ç–∞!`);
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
                checkLevelUp();
            } else {
                const damage = Math.floor(player.health * 0.2);
                player.health = Math.max(1, player.health - damage);
                
                showModal('–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!', `–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ ${opponent.username} –∏ –ø–æ—Ç–µ—Ä—è–ª–∏ ${damage} –∑–¥–æ—Ä–æ–≤—å—è.`);
            }
            
            updatePlayerUI();
            saveGame();
        }

        // –§—É–Ω–∫—Ü–∏—è –∞—Ç–∞–∫–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞
        function attackRandomOpponent() {
            const onlinePlayers = MultiplayerAPI.getOnlinePlayers();
            const opponentIds = Object.keys(onlinePlayers).filter(id => id !== player.id);
            
            if (opponentIds.length === 0) {
                showNotification('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤!', 'warning');
                return;
            }
            
            const randomOpponentId = opponentIds[Math.floor(Math.random() * opponentIds.length)];
            attackPlayer(randomOpponentId);
        }

        // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –≤ –∏–≥—Ä—É
        function login() {
            const username = usernameInput.value.trim();
            const password = passwordInput.value;
            
            if (!username) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!', 'warning');
                return;
            }
            
            if (username.length < 3) {
                showNotification('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤!', 'warning');
                return;
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –∏–≥—Ä–æ–∫–∞
            player.id = 'player_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω-–¥–æ—Å—Ç—É–ø–∞
            if (username === 'admin' && password === 'Zak222z8q') {
                player.isAdmin = true;
                adminTab.style.display = 'block';
                showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!', 'success');
            } else if (username === 'admin') {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!', 'error');
                return;
            }
            
            player.username = username;
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
            loadGame();
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω
            loginScreen.style.display = 'none';
            gameScreen.style.display = 'block';
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updatePlayerUI();
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
            MultiplayerAPI.addChatMessage('–°–∏—Å—Ç–µ–º–∞', `${username} –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –∏–≥—Ä–µ!`);
            
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}!`, 'success');
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–≥—Ä—ã
        function saveGame() {
            const saveData = {
                player: player,
                timestamp: Date.now()
            };
            
            localStorage.setItem('rpgFantasySave', JSON.stringify(saveData));
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã
        function loadGame() {
            const saveData = localStorage.getItem('rpgFantasySave');
            
            if (saveData) {
                try {
                    const parsedData = JSON.parse(saveData);
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞, –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—è –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞–¥–º–∏–Ω-—Å—Ç–∞—Ç—É—Å
                    const savedPlayer = parsedData.player;
                    player.level = savedPlayer.level || player.level;
                    player.exp = savedPlayer.exp || player.exp;
                    player.expToNextLevel = savedPlayer.expToNextLevel || player.expToNextLevel;
                    player.health = savedPlayer.health || player.health;
                    player.maxHealth = savedPlayer.maxHealth || player.maxHealth;
                    player.energy = savedPlayer.energy || player.energy;
                    player.maxEnergy = savedPlayer.maxEnergy || player.maxEnergy;
                    player.gold = savedPlayer.gold || player.gold;
                    player.skills = savedPlayer.skills || player.skills;
                    player.inventory = savedPlayer.inventory || player.inventory;
                    player.cooldowns = savedPlayer.cooldowns || player.cooldowns;
                    player.lastBonus = savedPlayer.lastBonus || player.lastBonus;
                    
                    showNotification('–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!', 'success');
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
                    showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ –∏–≥—Ä–æ–∫–∞
        function resetPlayer() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                player = {
                    id: player.id,
                    username: player.username,
                    level: 1,
                    exp: 0,
                    expToNextLevel: 100,
                    health: 100,
                    maxHealth: 100,
                    energy: 100,
                    maxEnergy: 100,
                    gold: 50,
                    isAdmin: player.isAdmin,
                    skills: {
                        strength: { level: 1, exp: 0, expToNextLevel: 100 },
                        agility: { level: 1, exp: 0, expToNextLevel: 100 },
                        intelligence: { level: 1, exp: 0, expToNextLevel: 100 },
                        stamina: { level: 1, exp: 0, expToNextLevel: 100 }
                    },
                    inventory: {
                        meat: { name: '–ú—è—Å–æ', count: 0, rarity: 'common' },
                        fish: { name: '–†—ã–±–∞', count: 0, rarity: 'common' },
                        ore: { name: '–†—É–¥–∞', count: 0, rarity: 'common' },
                        potion: { name: '–ü—Ä–æ—Å—Ç–æ–µ –∑–µ–ª—å–µ', count: 0, rarity: 'uncommon' },
                        sword: { name: '–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –º–µ—á', count: 0, rarity: 'uncommon' },
                        armor: { name: '–ö–æ–∂–∞–Ω–∞—è –±—Ä–æ–Ω—è', count: 0, rarity: 'rare' },
                        'super-potion': { name: '–£–ª—É—á—à–µ–Ω–Ω–æ–µ –∑–µ–ª—å–µ', count: 0, rarity: 'rare' },
                        'steel-sword': { name: '–°—Ç–∞–ª—å–Ω–æ–π –º–µ—á', count: 0, rarity: 'epic' },
                        amulet: { name: '–ú–∞–≥–∏—á–µ—Å–∫–∏–π –∞–º—É–ª–µ—Ç', count: 0, rarity: 'legendary' }
                    },
                    cooldowns: {
                        hunt: 0,
                        mine: 0,
                        fish: 0,
                        train: 0,
                        quest: 0,
                        bonus: 0,
                        dungeon: 0,
                        rest: 0
                    },
                    lastBonus: 0
                };
                
                updatePlayerUI();
                saveGame();
                showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω!', 'success');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥–∞
            loginButton.addEventListener('click', login);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è
            passwordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            registerLink.addEventListener('click', function(e) {
                e.preventDefault();
                showNotification('–î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±–æ—Ç Telegram!', 'info');
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
                    document.querySelectorAll('.nav-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    this.classList.add('active');
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å —á–∞—Ç –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É —á–∞—Ç–∞
                    if (tabId === 'chat') {
                        updateChat();
                    }
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
            document.querySelectorAll('.action-card').forEach(card => {
                card.addEventListener('click', function() {
                    if (!this.classList.contains('disabled')) {
                        const action = this.getAttribute('data-action');
                        handleAction(action);
                    }
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫—Ä–∞—Ñ—Ç–∞
            document.querySelectorAll('.craft-button').forEach(button => {
                button.addEventListener('click', function() {
                    const craft = this.getAttribute('data-craft');
                    handleCraft(craft);
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏—è –Ω–∞–≤—ã–∫–æ–≤
            document.querySelectorAll('.upgrade-button').forEach(button => {
                button.addEventListener('click', function() {
                    const skill = this.getAttribute('data-skill');
                    upgradeSkill(skill);
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ PvP
            document.querySelectorAll('.attack-button').forEach(button => {
                button.addEventListener('click', function() {
                    const opponent = this.getAttribute('data-opponent');
                    if (opponent === 'random') {
                        attackRandomOpponent();
                    } else {
                        attackPlayer(opponent);
                    }
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä—ã–Ω–∫–∞
            document.querySelectorAll('.buy-button').forEach(button => {
                button.addEventListener('click', function() {
                    const item = this.getAttribute('data-item');
                    buyItem(item);
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
            chatSend.addEventListener('click', sendChatMessage);
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendChatMessage();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            document.getElementById('add-gold').addEventListener('click', function() {
                if (!player.isAdmin) {
                    showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!', 'error');
                    return;
                }
                
                const amount = parseInt(document.getElementById('admin-gold').value) || 0;
                if (amount > 0) {
                    player.gold += amount;
                    updatePlayerUI();
                    saveGame();
                    showNotification(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${amount} –∑–æ–ª–æ—Ç–∞`, 'success');
                    document.getElementById('admin-gold').value = '';
                }
            });
            
            document.getElementById('add-exp').addEventListener('click', function() {
                if (!player.isAdmin) {
                    showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!', 'error');
                    return;
                }
                
                const amount = parseInt(document.getElementById('admin-exp').value) || 0;
                if (amount > 0) {
                    player.exp += amount;
                    checkLevelUp();
                    updatePlayerUI();
                    saveGame();
                    showNotification(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${amount} –æ–ø—ã—Ç–∞`, 'success');
                    document.getElementById('admin-exp').value = '';
                }
            });
            
            document.getElementById('set-level').addEventListener('click', function() {
                if (!player.isAdmin) {
                    showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!', 'error');
                    return;
                }
                
                const level = parseInt(document.getElementById('admin-level').value) || 1;
                if (level > 0 && level <= 100) {
                    player.level = level;
                    player.exp = 0;
                    player.expToNextLevel = 100 * Math.pow(1.5, level - 1);
                    player.maxHealth = 100 + (level - 1) * 10;
                    player.health = player.maxHealth;
                    player.maxEnergy = 100 + (level - 1) * 5;
                    player.energy = player.maxEnergy;
                    
                    updatePlayerUI();
                    saveGame();
                    showNotification(`–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —É—Ä–æ–≤–µ–Ω—å ${level}`, 'success');
                    document.getElementById('admin-level').value = '';
                }
            });
            
            document.getElementById('add-item').addEventListener('click', function() {
                if (!player.isAdmin) {
                    showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!', 'error');
                    return;
                }
                
                const item = document.getElementById('admin-item').value;
                const count = parseInt(document.getElementById('admin-item-count').value) || 1;
                
                if (count > 0) {
                    player.inventory[item].count += count;
                    updatePlayerUI();
                    saveGame();
                    showNotification(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${count} ${player.inventory[item].name}`, 'success');
                    document.getElementById('admin-item-count').value = '';
                }
            });
            
            document.getElementById('reset-player').addEventListener('click', function() {
                if (!player.isAdmin) {
                    showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!', 'error');
                    return;
                }
                
                resetPlayer();
            });
            
            document.getElementById('save-game').addEventListener('click', function() {
                if (!player.isAdmin) {
                    showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!', 'error');
                    return;
                }
                
                saveGame();
                showNotification('–ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!', 'success');
            });
            
            document.getElementById('load-game').addEventListener('click', function() {
                if (!player.isAdmin) {
                    showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!', 'error');
                    return;
                }
                
                loadGame();
                updatePlayerUI();
            });
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(saveGame, 30000);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                if (player.id) {
                    updateOnlineStatus();
                }
            }, 10000);
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
            loadGame();
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>